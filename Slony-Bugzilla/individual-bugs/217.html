<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <title>Bug 217 &ndash; Changing the primary key of a replicated table leads to trouble</title>


<link rel="Top" href="http://www.slony.info/bugzilla/">

  

  


  
    <link rel="Show" title="Dependency Tree"
          href="showdependencytree.cgi?id=217&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="showdependencygraph.cgi?id=217">


      <link rel="Show" title="Bug Activity"
            href="show_activity.cgi?id=217">
      <link rel="Show" title="Printer-Friendly Version"
            href="show_bug.cgi?format=multiple&amp;id=217">


    

    
      <link href="skins/standard/global.css"
            rel="stylesheet"
            type="text/css">
      <link href="skins/standard/yui/calendar.css"
            rel="stylesheet"
            type="text/css">
      <link href="skins/standard/show_bug.css"
            rel="stylesheet"
            type="text/css">
    <!--[if lte IE 7]>
      
      <link href="skins/standard/IE-fixes.css"
            rel="stylesheet"
            type="text/css">
    <![endif]-->

    
        <link href="skins/standard/global.css"
              rel="stylesheet"
              title="Classic"
              type="text/css">
        <link href="skins/standard/yui/calendar.css"
              rel="stylesheet"
              title="Classic"
              type="text/css">
        <link href="skins/standard/show_bug.css"
              rel="stylesheet"
              title="Classic"
              type="text/css">
      <!--[if lte IE 7]>
      
        <link href="skins/standard/IE-fixes.css"
              rel="stylesheet"
              title="Classic"
              type="text/css">
      <![endif]-->

    
        
            <link href="skins/contrib/Dusk/global.css"
                  rel="alternate stylesheet"
                  title="Dusk"
                  type="text/css">
            <link href="skins/contrib/Dusk/yui/calendar.css"
                  rel="alternate stylesheet"
                  title="Dusk"
                  type="text/css">
            <link href="skins/contrib/Dusk/show_bug.css"
                  rel="alternate stylesheet"
                  title="Dusk"
                  type="text/css">
        <!--[if lte IE 7]>
          
          <link href="skins/contrib/Dusk/IE-fixes.css"
                rel="alternate stylesheet"
                title="Dusk"
                type="text/css">
        <![endif]-->

    

    
        <link href="skins/custom/global.css" rel="stylesheet" type="text/css">
        <link href="skins/custom/yui/calendar.css" rel="stylesheet" type="text/css">
        <link href="skins/custom/show_bug.css" rel="stylesheet" type="text/css">
    <!--[if lte IE 7]>
      
      <link href="skins/custom/IE-fixes.css"
            rel="stylesheet"
            type="text/css">
    <![endif]-->

    <script src="js/yui/yahoo-dom-event.js" type="text/javascript"></script>
    <script src="js/global.js" type="text/javascript"></script>
    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        if (YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        var BUGZILLA = {
            param: {
                cookiepath: '\/'
            }
        };
    // -->
    </script>

        <script src="js/util.js" type="text/javascript"></script>
        <script src="js/field.js" type="text/javascript"></script>
        <script src="js/yui/calendar.js" type="text/javascript"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico" >
  </head>



  <body onload=""
        class="www-slony-info-bugzilla bz_bug bz_status_RESOLVED bz_product_Slony-I bz_component_trigger_SPI bz_bug_217">



<div id="header">
<div id="banner">
  </div>

<table border="0" cellspacing="0" cellpadding="0" id="titles">
<tr>
    <td id="title">
      <p>Bugzilla &ndash; Bug&nbsp;217</p>
    </td>

    <td id="subtitle">
      <p class="subheader">Changing the primary key of a replicated table leads to trouble</p>
    </td>

    <td id="information">
      <p class="header_addl_info">Last modified: 2011-06-16 10:19:14 PDT</p>
    </td>
</tr>
</table>
<ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch">
    <input class="btn" type="submit" value="Find" id="find_top"></form></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>


  <li>
        <span class="separator">| </span>
        <a href="docs/en/html/bug_page.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_top">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="?GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>
  <form action="http://www.slony.info/bugzilla/show_bug.cgi?id=217" method="POST" 
        class="mini_login bz_default_hidden"
        id="mini_login_top"
        onsubmit="return check_mini_login_fields( '_top' );"
  >
    <input id="Bugzilla_login_top" 
           class="bz_login"
           name="Bugzilla_login"
           onfocus="mini_login_on_focus('_top')"
    >
    <input class="bz_password" 
           id="Bugzilla_password_top" 
           name="Bugzilla_password"
           type="password"
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text" 
           id="Bugzilla_password_dummy_top" value="password"
           onfocus="mini_login_on_focus('_top')"
    >
    <input type="submit" name="GoAheadAndLogIn" value="Log in" 
            id="log_in_top">
    <script type="text/javascript">
      mini_login_constants = {
          "login" : "login",
          "warning" : "You must set the login and password before logging in."
      };
      
      if (YAHOO.env.ua.gecko || YAHOO.env.ua.ie || YAHOO.env.ua.opera) {
          YAHOO.util.Event.onDOMReady(function() {
              init_mini_login_form('_top');
          });
      }
      else {
          YAHOO.util.Event.on(window, 'load', function () {
              window.setTimeout(function() {
                  init_mini_login_form('_top');
              }, 200);
          });
    }
    </script>
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>
<li id="forgot_container_top">
  <span class="separator">| </span>
  <a id="forgot_link_top" href="?GoAheadAndLogIn=1#forgot"
     onclick="return show_forgot_form('_top')">Forgot Password</a>
  <form action="token.cgi" method="post" id="forgot_form_top"
        class="mini_forgot bz_default_hidden">
    <label>Login: <input type="text" name="loginname" size="20"></label>
    <input id="forgot_button_top" value="Reset Password" 
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <a href="#" onclick="return hide_forgot_form('_top')">[x]</a>
  </form>
</li>
</ul>

</div>

<div id="bugzilla-body">

<div class="navigation">
  
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">No search results available</font></i>
</div>
<script type="text/javascript">
  <!--
  
  /* Outputs a link to call replyToComment(); used to reduce HTML output */
  function addReplyLink(id, real_id) {
      /* XXX this should really be updated to use the DOM Core's
       * createElement, but finding a container isn't trivial.
       */
        document.write('[<a href="#add_comment" onclick="replyToComment(' + 
                       id + ',' + real_id + ');">reply<' + '/a>]');
  }

  /* Adds the reply text to the `comment' textarea */
  function replyToComment(id, real_id) {
      var prefix = "(In reply to comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);

        /* make sure we split on all newlines -- IE or Moz use \r and \n
         * respectively.
         */
        text = text.split(/\r|\n/);

        for (var i=0; i < text.length; i++) {
            replytext += "> " + text[i] + "\n"; 
        }

        replytext = prefix + replytext + "\n";


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      textarea.value += replytext;

      textarea.focus();
  }

  if (typeof Node == 'undefined') {
      /* MSIE doesn't define Node, so provide a compatibility object */
      window.Node = {
          TEXT_NODE: 3,
          ENTITY_REFERENCE_NODE: 5
      };
  }

  /* Concatenates all text from element's childNodes. This is used
   * instead of innerHTML because we want the actual text (and
   * innerText is non-standard).
   */
  function getText(element) {
      var child, text = "";
      for (var i=0; i < element.childNodes.length; i++) {
          child = element.childNodes[i];
          var type = child.nodeType;
          if (type == Node.TEXT_NODE || type == Node.ENTITY_REFERENCE_NODE) {
              text += child.nodeValue;
          } else {
              /* recurse into nodes of other types */
              text += getText(child);
          }
      }
      return text;
  }


  //-->
  </script>

<form name="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2011-06-16 10:19:14">
  <input type="hidden" name="longdesclength" value="21">
  <input type="hidden" name="id" value="217">
  <input type="hidden" name="token" value="1433217837-4065a9e99604742933df3332f2b0ed60">
<div class="bz_alias_short_desc_container edit_form">
     <a href="show_bug.cgi?id=217">
        <b>Bug&nbsp;217</b></a> - 
     <span id="summary_alias_container" class="bz_default_hidden"> 
      <span id="short_desc_nonedit_display">Changing the primary key of a replicated table leads to trouble</span>
     </span>
  
       
    <div id="summary_alias_input">
      <table id="summary">  
        
        <tr>
          <td>
            <label accesskey="s" for="short_desc"><u>S</u>ummary</label>:
          </td>
          <td>Changing the primary key of a replicated table leads to trouble
          </td>
        </tr>
      </table>
    </div>
  </div>
  <script type="text/javascript">
    hideAliasAndSummary('Changing the primary key of a replicated table leads to trouble', '');
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <td class="field_label">
      <b><a href="page.cgi?id=fields.html#status">Status</a></b>:
    </td>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr>
<th class="field_label "
      id="field_label_product">
        <a href="describecomponents.cgi">Product:</a>
  </th>

<td class="field_value "
    id="field_container_product" >Slony-I</td>
    </tr>
        
    
    
    <tr>
      <td class="field_label">
        <label for="component" accesskey="m">
          <b><a href="describecomponents.cgi?product=Slony-I">
            Co<u>m</u>ponent</a>:
          </b>
        </label>
      </td><td>trigger SPI
  </td>
    </tr>
    <tr>
      <td class="field_label">
        <label for="version"><b>Version</b></label>:
      </td>
<td>2.0
  </td>
    </tr>
        
    
        
    <tr>
      <td class="field_label">
        <label for="rep_platform" accesskey="h"><b>Platform</b></label>:
      </td>
      <td class="field_value">PC
       Linux
       <script type="text/javascript">
         assignToDefaultOnChange(['product', 'component']);
       </script>
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <td class="field_label">
        <label for="priority" accesskey="i">
          <b><a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></b></label>:
      </td>
      <td>high
       critical
      </td>
    </tr>            
          
          <tr>
      <td class="field_label">
        <b><a href="page.cgi?id=fields.html#assigned_to">Assigned To</a></b>:
      </td>
      <td><span class="vcard"><span class="fn">Steve Singer</span>
</span>
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr>
    <td class="field_label">
      <label for="bug_file_loc" accesskey="u"><b>
          <u>U</u>RL</b></label>:
    </td>
    <td>
      <span id="bz_url_input_area">
          <a href=""></a>
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr><th class="field_label">
    <label for="dependson">Depends&nbsp;on</label>:
  </th>
  <td>    
    <span id="dependson_input_area">
    </span>
    
  </td>
  </tr>
  
  <tr><th class="field_label">
    <label for="blocked" accesskey="b"><u>B</u>locks</label>:
  </th>
  <td>    
    <span id="blocked_input_area">
    </span>
    
  </td>
  
  <tr>
    <th>&nbsp;</th>
  
    <td colspan="2" align="left" id="show_dependency_tree_or_graph">
      Show dependency <a href="showdependencytree.cgi?id=217&amp;hide_resolved=1">tree</a>
  
        /&nbsp;<a href="showdependencygraph.cgi?id=217">graph</a>
    </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table cellpadding="3" cellspacing="1">
        <tr>
    <td class="field_label">
      <b>Reported</b>:
    </td>
    <td>2011-05-27 12:33 PDT by <span class="vcard"><span class="fn">Steve Singer</span>
</span>
    </td>
  </tr>
  
  <tr>
    <td class="field_label">
      <b> Modified</b>:
    </td>
    <td>2011-06-16 10:19 PDT 
      (<a href="show_activity.cgi?id=217">History</a>)
    </td>
  
  </tr>
         <tr>
      <td class="field_label">
        <label for="newcc" accesskey="a"><b>CC List</b>:</label>
      </td>
      <td>1 
          user
        <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
          (<a href="#" id="cc_edit_area_showhide">show</a>)
        </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" name="cc" multiple="multiple" size="5">
                <option value="slony1-bugs">slony1-bugs</option>
            </select>
        </div>
        <script type="text/javascript">
          hideEditableField( 'cc_edit_area_showhide_container', 
                             'cc_edit_area', 
                             'cc_edit_area_showhide', 
                             '', 
                             '');  
        </script>
      </td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
      id="field_label_see_also">
        <a href="page.cgi?id=fields.html#see_also">See Also:</a>
  </th>

<td class="field_value "
    id="field_container_see_also" ></td>
    </tr> 
         
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
         
                

        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  
  


<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
    }
    else {
        link.innerHTML = "Hide Obsolete";
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table" cellspacing="0" cellpadding="4">
  <tr>
    <th colspan="2" align="left">
      <a name="a0" id="a0">Attachments</a>
    </th>
  </tr>


      <tr class="">
        <td valign="top">
            <a name="a1" href="attachment.cgi?id=100"
               title="View the content of the attachment">
          <b>A function to recreate the trigger with the arguments for the new primary key</b></a>

          <span class="bz_attach_extra_info">
              (1.95 KB,
                patch)

            <br>
            <a href="#attach_100"
               title="Go to the comment associated with the attachment">2011-05-30 08:08 PDT</a>,
<span class="vcard"><span class="fn">Steve Singer</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=100&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=100&amp;action=diff">Diff</a>
        </td>
      </tr>
      <tr class="">
        <td valign="top">
            <a name="a2" href="attachment.cgi?id=101"
               title="View the content of the attachment">
          <b>patch to have execute script automatically fix tables</b></a>

          <span class="bz_attach_extra_info">
              (3.91 KB,
                patch)

            <br>
            <a href="#attach_101"
               title="Go to the comment associated with the attachment">2011-05-31 08:18 PDT</a>,
<span class="vcard"><span class="fn">Steve Singer</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=101&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=101&amp;action=diff">Diff</a>
        </td>
      </tr>
      <tr class="">
        <td valign="top">
            <a name="a3" href="attachment.cgi?id=102"
               title="View the content of the attachment">
          <b>updates to the patch for 9.0 support</b></a>

          <span class="bz_attach_extra_info">
              (5.83 KB,
                patch)

            <br>
            <a href="#attach_102"
               title="Go to the comment associated with the attachment">2011-06-03 11:58 PDT</a>,
<span class="vcard"><span class="fn">Steve Singer</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=102&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=102&amp;action=diff">Diff</a>
        </td>
      </tr>
      <tr class="">
        <td valign="top">
            <a name="a4" href="attachment.cgi?id=105"
               title="View the content of the attachment">
          <b>Add PK test to the set of regression tests typically run</b></a>

          <span class="bz_attach_extra_info">
              (1.52 KB,
                patch)

            <br>
            <a href="#attach_105"
               title="Go to the comment associated with the attachment">2011-06-08 15:05 PDT</a>,
<span class="vcard"><span class="fn">Christopher Browne</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=105&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=105&amp;action=diff">Diff</a>
        </td>
      </tr>
      <tr class=" bz_tr_obsolete bz_default_hidden">
        <td valign="top">
            <a name="a5" href="attachment.cgi?id=108"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">replace C function to decode trigger arguments with string matching</span></b></a>

          <span class="bz_attach_extra_info">
              (3.57 KB,
                patch)

            <br>
            <a href="#attach_108"
               title="Go to the comment associated with the attachment">2011-06-10 06:39 PDT</a>,
<span class="vcard"><span class="fn">Steve Singer</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=108&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=108&amp;action=diff">Diff</a>
        </td>
      </tr>
      <tr class="">
        <td valign="top">
            <a name="a6" href="attachment.cgi?id=109"
               title="View the content of the attachment">
          <b>replace C function to decode trigger arguments (updated)</b></a>

          <span class="bz_attach_extra_info">
              (3.56 KB,
                patch)

            <br>
            <a href="#attach_109"
               title="Go to the comment associated with the attachment">2011-06-10 07:52 PDT</a>,
<span class="vcard"><span class="fn">Steve Singer</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=109&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=109&amp;action=diff">Diff</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="2">
        <span class="bz_attach_view_hide">
            <a href="#a0" onclick="return toggle_display(this);">Show
              Obsolete</a> (1)
        </span>
      <a href="attachment.cgi?bugid=217&amp;action=enter">Add an attachment</a>
      (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>




  <br>
  <table cellpadding="1" cellspacing="1">
    <tr>
      <td id="comment_status_commit">
        <!-- The table keeps the commit button aligned with the box. -->
        <a name="add_comment"></a>
          <fieldset>
            <legend>Note</legend>
            <p>
              You need to
              <a href="show_bug.cgi?id=217&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </p>
          </fieldset>
        
        <hr>
        <div id="comments"><script type="text/javascript">
  <!--
  function updateCommentPrivacy(checkbox, id) {
    var comment_elem = document.getElementById('comment_text_'+id).parentNode;
    if (checkbox.checked) {
      if (!comment_elem.className.match('bz_private')) {
        comment_elem.className = comment_elem.className.concat(' bz_private');
      }
    }
    else {
      comment_elem.className =
        comment_elem.className.replace(/(\s*|^)bz_private(\s*|$)/, '$2');
    }
  }

  /* The functions below expand and collapse comments  */

  function toggle_comment_display(link, comment_id) {
    var comment = document.getElementById('comment_text_' + comment_id);
    var re = new RegExp(/\bcollapsed\b/);
    if (comment.className.match(re))
        expand_comment(link, comment);
    else
        collapse_comment(link, comment);
  }

  function toggle_all_comments(action) {
    var num_comments = 21;

    // If for some given ID the comment doesn't exist, this doesn't mean
    // there are no more comments, but that the comment is private and
    // the user is not allowed to view it.

    for (var id = 0; id < num_comments; id++) {
        var comment = document.getElementById('comment_text_' + id);
        if (!comment)
            continue;

        var link = document.getElementById('comment_link_' + id);
        if (action == 'collapse')
            collapse_comment(link, comment);
        else
            expand_comment(link, comment);
    }
  }

  function collapse_comment(link, comment) {
    link.innerHTML = "[+]";
    link.title = "Expand the comment.";
    YAHOO.util.Dom.addClass(comment, 'collapsed');
  }

  function expand_comment(link, comment) {
    link.innerHTML = "[-]";
    link.title = "Collapse the comment";
    YAHOO.util.Dom.removeClass(comment, 'collapsed');
  }

  /* This way, we are sure that browsers which do not support JS
   * won't display this link  */

  function addCollapseLink(count) {
    document.write(' <a href="#" class="bz_collapse_comment"' +
                   ' id="comment_link_' + count +
                   '" onclick="toggle_comment_display(this, ' +  count +
                   '); return false;" title="Collapse the comment.">[-]<\/a> ');
  }
  //-->
  </script>








<div class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">



        <span class="bz_comment_number">
          <a name="c0" 
             href="show_bug.cgi?id=217#c0">Description</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Steve Singer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-05-27 12:33:04 PDT
        </span>
      </div>



<pre class="bz_comment_text" >This bug has been confirmed in slony 2.1.0 but I would expect it to show up in
2.0.x but not 1.2 or earlier.

Say you have a table test1
create table test1 (
       id1 int4 not null,
       id2 int4 not null,
       id3 int4,
       data text
);
create unique index test1_pkey on test1(id1);

insert into test1(id1,id2,id3,data) values (1,1,1,'test');
insert into test1(id1,id2,id3,data) values (2,2,1,'test2');

and you replicate it specifying the unique index pkey1 on the 'set add table..'
line.

Then you execute the following script through EXECUTE SCRIPT

drop index test1_pkey;
create unique index test1_pkey on test1(id1,id2);
update test1 set id1=1;

Then on the master you do 
update test1 set data='bar' where id2=2

The update matches 1 row on the master.  However when it runs on the slave
slony thinks the primary key is (id1) so it only includes id1 in the where
clause.   This means that two rows will be changed on the slave.

The trigger definition arguments contains 'k' initially, and we have no way of
updating it to 'kk',  nor does the trigger (today) have any way of knowing (at
runtime) that the index has changed.</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c1" 
             href="show_bug.cgi?id=217#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Christopher Browne</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-05-27 13:31:22 PDT
        </span>
      </div>



<pre class="bz_comment_text" >I see that a test case for this has been added to HEAD...

<a href="http://git.postgresql.org/gitweb?p=slony1-engine.git;a=commit;h=1ff9059f1a25ddc58e7ac729eb5c2ef822ede8cf">http://git.postgresql.org/gitweb?p=slony1-engine.git;a=commit;h=1ff9059f1a25ddc58e7ac729eb5c2ef822ede8cf</a></pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c2" 
             href="show_bug.cgi?id=217#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Christopher Browne</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-05-27 13:34:48 PDT
        </span>
      </div>



<pre class="bz_comment_text" >A solution strategy for this may be to create a function that rummages through
all replicated tables, checking to see if the triggers have 'kvvkvk' values
that correspond to the primary key for each respective table, fixing that, if
it should fail to match.

Such a function would be run by EXECUTE SCRIPT, automatically.

It could presumably also be run manually, against each node, if someone has
decided to mess with the tables by hand, via psql.</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c3" 
             href="show_bug.cgi?id=217#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Steve Singer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-05-30 07:29:01 PDT
        </span>
      </div>



<pre class="bz_comment_text" >The following query will detect if the primary key/unique index has changed
since the log trigger was created.

select  tab_relname from _test.sl_table, pg_trigger where tab_reloid=tgrelid
and
_test.determineAttKindUnique(tab_nspname||'.'||tab_relname,tab_idxname)!=(string_to_array(tgargs::text,E'\\000'::text))[3];

(where _test is the slony schema name, replace with your slony schema name)</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c4" 
             href="show_bug.cgi?id=217#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Steve Singer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-05-30 08:08:05 PDT
        </span>
      </div>



<pre class="bz_comment_text" ><span class=""><a href="attachment.cgi?id=100" name="attach_100" title="A function to recreate the trigger with the arguments for the new primary key">Created an attachment (id=100)</a> <a href="attachment.cgi?id=100&amp;action=edit" title="A function to recreate the trigger with the arguments for the new primary key">[details]</a></span>
A function to recreate the trigger with the arguments for the new primary key</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c5" 
             href="show_bug.cgi?id=217#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Steve Singer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-05-30 08:16:25 PDT
        </span>
      </div>



<pre class="bz_comment_text" >I have now attached

a) A query to detect tables with modified indexes/pkeys
b) A function to drop the trigger and re-add it with the proper/new arguments
(this takes an exclusive lock on the table)

We can modify EXECUTE SCRIPT to check all replicated tables and fix them if
they require fixing.  Another approach would be to have EXECUTE SCRIPT only fix
tables that the current transaction already has an exclusive lock on.  If the
SQL script submitted to execute script actually changed the primary
key/constraint on the table then the transaction would already hold that lock. 
 This condition would mean that EXECUTE SCRIPT still won't obtain any exclusive
locks in addition to what the SQL script already has.  The downside is that if
a table has the wrong trigger arguments prior to EXECUTE SCRIPT being called
(ie the primary key was changed outside of EXECUTE SCRIPT and
recreate_log_trigger wasn't called) then the error will remain.</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c6" 
             href="show_bug.cgi?id=217#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Christopher Browne</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-05-30 08:45:00 PDT
        </span>
      </div>



<pre class="bz_comment_text" >There exist arguments both ways:

1.  Only running this against tables that already have locks taken out means
we're not escalating locks, and we can indeed be confident that any tables that
are being modified in *THIS* DDL script will already be locked.

2.  If we don't fix all tables that need fixing, then we're leaving a broken
state in place.  The DDL request may demand some locks that it didn't already
have, but only against tables that probably can't replicate properly.  Doesn't
that seem like a high priority fix???

I'd be inclined to fix all tables that need fixing, otherwise, replication
remains broken for those tables.</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c7" 
             href="show_bug.cgi?id=217#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Steve Singer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-05-30 12:27:35 PDT
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=217#c3">comment #3</a>)
<span class="quote">&gt; The following query will detect if the primary key/unique index has changed
&gt; since the log trigger was created.
&gt; 
&gt; select  tab_relname from _test.sl_table, pg_trigger where tab_reloid=tgrelid
&gt; and
&gt; _test.determineAttKindUnique(tab_nspname||'.'||tab_relname,tab_idxname)!=(string_to_array(tgargs::text,E'\\000'::text))[3];
&gt; 
&gt; (where _test is the slony schema name, replace with your slony schema name)</span >

A better version of the query is

select  tab_relname from _test.sl_table, pg_trigger where tab_reloid=tgrelid
and
_test.determineAttKindUnique(tab_nspname||'.'||tab_relname,tab_idxname)!=(string_to_array(tgargs::text,E'\\000'::text))[3]
and tgname='_test_logtrigger';

(Note the and tgname='....' to only include the log triggers.)</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c8" 
             href="show_bug.cgi?id=217#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Steve Singer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-05-31 08:18:34 PDT
        </span>
      </div>



<pre class="bz_comment_text" ><span class=""><a href="attachment.cgi?id=101" name="attach_101" title="patch to have execute script automatically fix tables">Created an attachment (id=101)</a> <a href="attachment.cgi?id=101&amp;action=edit" title="patch to have execute script automatically fix tables">[details]</a></span>
patch to have execute script automatically fix tables

This patch to be applied ontop of the previous one will have EXECUTE SCRIPT
automatically repair logtriggers (that need it) that are already locked by the
script.  (this is option (b) in the discussion).  It is a one line change to
the patch to make it implement option (a).   The repair_log_triggers
function(true/false) could also be called manually by users.</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c9" 
             href="show_bug.cgi?id=217#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Steve Singer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-02 13:52:01 PDT
        </span>
      </div>



<pre class="bz_comment_text" >These patches do not work with 9.0

tgargs in pg_trigger is now stored in a different format.

Does anyone know how to decode this? 
In a way that works in all versions of PG?</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c10" 
             href="show_bug.cgi?id=217#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Steve Singer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-03 11:58:31 PDT
        </span>
      </div>



<pre class="bz_comment_text" ><span class=""><a href="attachment.cgi?id=102" name="attach_102" title="updates to the patch for 9.0 support">Created an attachment (id=102)</a> <a href="attachment.cgi?id=102&amp;action=edit" title="updates to the patch for 9.0 support">[details]</a></span>
updates to the patch for 9.0 support

This update to the patch adds a C function that will decode tgargs in 9.0.

It will also print a warning on tables that need repair but are skipped because
no lock was previously obtained on the table.</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c11" 
             href="show_bug.cgi?id=217#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Christopher Browne</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-08 15:05:10 PDT
        </span>
      </div>



<pre class="bz_comment_text" ><span class=""><a href="attachment.cgi?id=105" name="attach_105" title="Add PK test to the set of regression tests typically run">Created an attachment (id=105)</a> <a href="attachment.cgi?id=105&amp;action=edit" title="Add PK test to the set of regression tests typically run">[details]</a></span>
Add PK test to the set of regression tests typically run

Here's an additional patch to add in the additional regression test.

FYI, it ran fine for me against 2.0, based on your branch, <span class="bz_closed"><a href="show_bug.cgi?id=217" title="RESOLVED FIXED - Changing the primary key of a replicated table leads to trouble">bug217</a></span>_20.</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c12" 
             href="show_bug.cgi?id=217#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Christopher Browne</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-09 09:38:42 PDT
        </span>
      </div>



<pre class="bz_comment_text" >It scares me that decoding trigger arguments required an SPI function.

Actually, poking at pg_trigger suggests that the problem isn't at the Slony
level...  I wonder who came up with the notion that the following was
reasonable...

slonyregress1@localhost-&gt;  select tgnargs, tgargs from pg_trigger where tgnargs
<span class="quote">&gt; 0;</span >
 tgnargs |                           tgargs
---------+------------------------------------------------------------
       3 | \x5f736c6f6e795f72656772657373310031006b00
       1 | \x5f736c6f6e795f726567726573733100
       3 | \x5f736c6f6e795f72656772657373310032006b00
       1 | \x5f736c6f6e795f726567726573733100
       3 | \x5f736c6f6e795f72656772657373310034006b00
       1 | \x5f736c6f6e795f726567726573733100
       3 | \x5f736c6f6e795f72656772657373310035006b76766b767676766b00
       1 | \x5f736c6f6e795f726567726573733100
(8 rows)

I'd be inclined to feed some griping about this representation up to
pgsql-hackers, in the hopes of getting something nicer, maybe?

Not that that's too likely for 9.1 :-)</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c13" 
             href="show_bug.cgi?id=217#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Jan Wieck</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-09 12:04:01 PDT
        </span>
      </div>



<pre class="bz_comment_text" >Maybe we aren't supposed to query pg_trigger, but query the
information_schema.triggers view instead?


Jan</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c14" 
             href="show_bug.cgi?id=217#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Steve Singer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-09 12:37:08 PDT
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=217#c13">comment #13</a>)
<span class="quote">&gt; Maybe we aren't supposed to query pg_trigger, but query the
&gt; information_schema.triggers view instead?
&gt; 
&gt; 
&gt; Jan</span >

The information schema gives rows like


 EXECUTE PROCEDURE _slonyregress.logtrigger('_slonyregress', '1', 'k')


we could

a) build up a similar line in the query in the plpgsql function and do a text
comparision
b) Do regex matching to extract the 'k' from the arguments
c) use the C function like the patch proposes.

I dislike (b).  I'm not opposed to (a), but comparing just the trigger
arguments seems more direct to me, even if it involves a C function to get them</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c15" 
             href="show_bug.cgi?id=217#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Jan Wieck</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-09 13:52:25 PDT
        </span>
      </div>



<pre class="bz_comment_text" >I would favor a). Although it will lead to a rather cryptic and non-intuitive
behavior should the information_schema.triggers view ever change the
representation (it didn't since 8.3 and I didn't bother checking earlier
versions). What it would tell is that all the unlocked tables have changed but
it won't do anything about it. Then again any regexp implementation could
behave just the same, so there is not much to gain from that.


Jan</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c16" 
             href="show_bug.cgi?id=217#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Christopher Browne</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-09 14:29:56 PDT
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=217#c15">comment #15</a>)
<span class="quote">&gt; I would favor a). Although it will lead to a rather cryptic and non-intuitive
&gt; behavior should the information_schema.triggers view ever change the
&gt; representation (it didn't since 8.3 and I didn't bother checking earlier
&gt; versions). What it would tell is that all the unlocked tables have changed but
&gt; it won't do anything about it. Then again any regexp implementation could
&gt; behave just the same, so there is not much to gain from that.</span >

I suggest that if we guard ourselves by having a decent regression test, so
that if the view changes, we're quite likely to notice, then yes, a) seems
better to me.</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c17" 
             href="show_bug.cgi?id=217#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Steve Singer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-10 06:39:39 PDT
        </span>
      </div>



<pre class="bz_comment_text" ><span class="bz_obsolete"><a href="attachment.cgi?id=108" name="attach_108" title="replace C function to decode trigger arguments with string matching">Created an attachment (id=108)</a> <a href="attachment.cgi?id=108&amp;action=edit" title="replace C function to decode trigger arguments with string matching">[details]</a></span>
replace C function to decode trigger arguments with string matching

This patch to be appplied ontop of the others will remove the C function that
decodes the trigger arguments and replaces it with string matching code against
information_schema.triggers.

I feel that the C function is cleaner and more future proof.  To get this patch
to work I had to be careful about matching spaces and quotes in the function
with the format the information schema returns.  I have not yet done a lot of
testing and suspect that this version of the patch might break with mixed case
slony clusternames (if so that should be fixable).

The C function works and should continue to work with future postgres versions
because it uses the same infrastructure to decode tgargs as postgersql uses
when it invokes the trigger.  With the string matching approach we are
depending on a unit test to tell us that something suttle has changed in
postgresql after the fact.</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c18" 
             href="show_bug.cgi?id=217#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Steve Singer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-10 07:52:22 PDT
        </span>
      </div>



<pre class="bz_comment_text" ><span class=""><a href="attachment.cgi?id=109" name="attach_109" title="replace C function to decode trigger arguments (updated)">Created an attachment (id=109)</a> <a href="attachment.cgi?id=109&amp;action=edit" title="replace C function to decode trigger arguments (updated)">[details]</a></span>
replace C function to decode trigger arguments (updated)

Updating patch to not print extra warning messages + deal better with mixed
case slony schemas</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c19" 
             href="show_bug.cgi?id=217#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Steve Singer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-14 06:29:03 PDT
        </span>
      </div>



<pre class="bz_comment_text" >(In reply to <a href="show_bug.cgi?id=217#c18">comment #18</a>)
<span class="quote">&gt; Created an <span class=""><a href="attachment.cgi?id=109" name="attach_109" title="replace C function to decode trigger arguments (updated)">attachment (id=109)</a> <a href="attachment.cgi?id=109&amp;action=edit" title="replace C function to decode trigger arguments (updated)">[details]</a></span> [details]
&gt; replace C function to decode trigger arguments (updated)
&gt; 
&gt; Updating patch to not print extra warning messages + deal better with mixed
&gt; case slony schemas</span >

It turns out that the fixes to make strings match with mixed case breaks all
lower case schema names.

This is another example of why I think the string matching approach is a bad
idea.
If you disagree with me then take a look at this then spend some time trying to
fix the patch so it works in both with the various versions of Pg.

Otherwise I think we should go back to the C function for decoding these
trigger arguments.</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c20" 
             href="show_bug.cgi?id=217#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Steve Singer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-06-16 10:19:14 PDT
        </span>
      </div>



<pre class="bz_comment_text" >The approach with the c function has been committed to both REL_2_0_STABLE for
inclusion in 2.0.7.rc2 and master.

<a href="http://git.postgresql.org/gitweb?p=slony1-engine.git;a=commit;h=663dc7dc36ca6329d50b5f8bc91faac6932e5cb8">http://git.postgresql.org/gitweb?p=slony1-engine.git;a=commit;h=663dc7dc36ca6329d50b5f8bc91faac6932e5cb8</a>
<a href="http://git.postgresql.org/gitweb?p=slony1-engine.git;a=commit;h=db8af76a66bc79867ec4845ecf40192cf05c85d6">http://git.postgresql.org/gitweb?p=slony1-engine.git;a=commit;h=db8af76a66bc79867ec4845ecf40192cf05c85d6</a></pre>
    </div>
        </div>
        
      </td>
    </tr>
  </table>
</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=217">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=217">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=217">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>        


<div class="navigation">
  
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">No search results available</font></i>
</div>

<br>
</div>



<div id="footer">
  <div class="intro"></div>




<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch">
    <input class="btn" type="submit" value="Find" id="find_bottom"></form></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>


  <li>
        <span class="separator">| </span>
        <a href="docs/en/html/bug_page.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_bottom">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="?GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>
  <form action="http://www.slony.info/bugzilla/show_bug.cgi?id=217" method="POST" 
        class="mini_login bz_default_hidden"
        id="mini_login_bottom"
        onsubmit="return check_mini_login_fields( '_bottom' );"
  >
    <input id="Bugzilla_login_bottom" 
           class="bz_login"
           name="Bugzilla_login"
           onfocus="mini_login_on_focus('_bottom')"
    >
    <input class="bz_password" 
           id="Bugzilla_password_bottom" 
           name="Bugzilla_password"
           type="password"
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text" 
           id="Bugzilla_password_dummy_bottom" value="password"
           onfocus="mini_login_on_focus('_bottom')"
    >
    <input type="submit" name="GoAheadAndLogIn" value="Log in" 
            id="log_in_bottom">
    <script type="text/javascript">
      mini_login_constants = {
          "login" : "login",
          "warning" : "You must set the login and password before logging in."
      };
      
      if (YAHOO.env.ua.gecko || YAHOO.env.ua.ie || YAHOO.env.ua.opera) {
          YAHOO.util.Event.onDOMReady(function() {
              init_mini_login_form('_bottom');
          });
      }
      else {
          YAHOO.util.Event.on(window, 'load', function () {
              window.setTimeout(function() {
                  init_mini_login_form('_bottom');
              }, 200);
          });
    }
    </script>
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>
<li id="forgot_container_bottom">
  <span class="separator">| </span>
  <a id="forgot_link_bottom" href="?GoAheadAndLogIn=1#forgot"
     onclick="return show_forgot_form('_bottom')">Forgot Password</a>
  <form action="token.cgi" method="post" id="forgot_form_bottom"
        class="mini_forgot bz_default_hidden">
    <label>Login: <input type="text" name="loginname" size="20"></label>
    <input id="forgot_button_bottom" value="Reset Password" 
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <a href="#" onclick="return hide_forgot_form('_bottom')">[x]</a>
  </form>
</li>
</ul>
  </li>

  
    

  


  
</ul>

  <div class="outro"></div>
</div>

</body>
</html>