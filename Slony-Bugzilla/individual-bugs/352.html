<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <title>Bug 352 &ndash; Postgres HEAD refactored INT64_FORMAT out of pg_config.h</title>


<link rel="Top" href="http://www.slony.info/bugzilla/">

  

  


  
    <link rel="Show" title="Dependency Tree"
          href="showdependencytree.cgi?id=352&amp;hide_resolved=1">
      <link rel="Show" title="Dependency Graph"
            href="showdependencygraph.cgi?id=352">


      <link rel="Show" title="Bug Activity"
            href="show_activity.cgi?id=352">
      <link rel="Show" title="Printer-Friendly Version"
            href="show_bug.cgi?format=multiple&amp;id=352">


    

    
      <link href="skins/standard/global.css"
            rel="stylesheet"
            type="text/css">
      <link href="skins/standard/yui/calendar.css"
            rel="stylesheet"
            type="text/css">
      <link href="skins/standard/show_bug.css"
            rel="stylesheet"
            type="text/css">
    <!--[if lte IE 7]>
      
      <link href="skins/standard/IE-fixes.css"
            rel="stylesheet"
            type="text/css">
    <![endif]-->

    
        <link href="skins/standard/global.css"
              rel="stylesheet"
              title="Classic"
              type="text/css">
        <link href="skins/standard/yui/calendar.css"
              rel="stylesheet"
              title="Classic"
              type="text/css">
        <link href="skins/standard/show_bug.css"
              rel="stylesheet"
              title="Classic"
              type="text/css">
      <!--[if lte IE 7]>
      
        <link href="skins/standard/IE-fixes.css"
              rel="stylesheet"
              title="Classic"
              type="text/css">
      <![endif]-->

    
        
            <link href="skins/contrib/Dusk/global.css"
                  rel="alternate stylesheet"
                  title="Dusk"
                  type="text/css">
            <link href="skins/contrib/Dusk/yui/calendar.css"
                  rel="alternate stylesheet"
                  title="Dusk"
                  type="text/css">
            <link href="skins/contrib/Dusk/show_bug.css"
                  rel="alternate stylesheet"
                  title="Dusk"
                  type="text/css">
        <!--[if lte IE 7]>
          
          <link href="skins/contrib/Dusk/IE-fixes.css"
                rel="alternate stylesheet"
                title="Dusk"
                type="text/css">
        <![endif]-->

    

    
        <link href="skins/custom/global.css" rel="stylesheet" type="text/css">
        <link href="skins/custom/yui/calendar.css" rel="stylesheet" type="text/css">
        <link href="skins/custom/show_bug.css" rel="stylesheet" type="text/css">
    <!--[if lte IE 7]>
      
      <link href="skins/custom/IE-fixes.css"
            rel="stylesheet"
            type="text/css">
    <![endif]-->

    <script src="js/yui/yahoo-dom-event.js" type="text/javascript"></script>
    <script src="js/global.js" type="text/javascript"></script>
    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        if (YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        var BUGZILLA = {
            param: {
                cookiepath: '\/'
            }
        };
    // -->
    </script>

        <script src="js/util.js" type="text/javascript"></script>
        <script src="js/field.js" type="text/javascript"></script>
        <script src="js/yui/calendar.js" type="text/javascript"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico" >
  </head>



  <body onload=""
        class="www-slony-info-bugzilla bz_bug bz_status_RESOLVED bz_product_Slony-I bz_component_slon bz_bug_352">



<div id="header">
<div id="banner">
  </div>

<table border="0" cellspacing="0" cellpadding="0" id="titles">
<tr>
    <td id="title">
      <p>Bugzilla &ndash; Bug&nbsp;352</p>
    </td>

    <td id="subtitle">
      <p class="subheader">Postgres HEAD refactored INT64_FORMAT out of pg_config.h</p>
    </td>

    <td id="information">
      <p class="header_addl_info">Last modified: 2014-12-15 16:20:43 PST</p>
    </td>
</tr>
</table>
<ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch">
    <input class="btn" type="submit" value="Find" id="find_top"></form></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>


  <li>
        <span class="separator">| </span>
        <a href="docs/en/html/bug_page.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_top">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="?GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>
  <form action="http://www.slony.info/bugzilla/show_bug.cgi?id=352" method="POST" 
        class="mini_login bz_default_hidden"
        id="mini_login_top"
        onsubmit="return check_mini_login_fields( '_top' );"
  >
    <input id="Bugzilla_login_top" 
           class="bz_login"
           name="Bugzilla_login"
           onfocus="mini_login_on_focus('_top')"
    >
    <input class="bz_password" 
           id="Bugzilla_password_top" 
           name="Bugzilla_password"
           type="password"
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text" 
           id="Bugzilla_password_dummy_top" value="password"
           onfocus="mini_login_on_focus('_top')"
    >
    <input type="submit" name="GoAheadAndLogIn" value="Log in" 
            id="log_in_top">
    <script type="text/javascript">
      mini_login_constants = {
          "login" : "login",
          "warning" : "You must set the login and password before logging in."
      };
      
      if (YAHOO.env.ua.gecko || YAHOO.env.ua.ie || YAHOO.env.ua.opera) {
          YAHOO.util.Event.onDOMReady(function() {
              init_mini_login_form('_top');
          });
      }
      else {
          YAHOO.util.Event.on(window, 'load', function () {
              window.setTimeout(function() {
                  init_mini_login_form('_top');
              }, 200);
          });
    }
    </script>
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>
<li id="forgot_container_top">
  <span class="separator">| </span>
  <a id="forgot_link_top" href="?GoAheadAndLogIn=1#forgot"
     onclick="return show_forgot_form('_top')">Forgot Password</a>
  <form action="token.cgi" method="post" id="forgot_form_top"
        class="mini_forgot bz_default_hidden">
    <label>Login: <input type="text" name="loginname" size="20"></label>
    <input id="forgot_button_top" value="Reset Password" 
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <a href="#" onclick="return hide_forgot_form('_top')">[x]</a>
  </form>
</li>
</ul>

</div>

<div id="bugzilla-body">

<div class="navigation">
  
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">No search results available</font></i>
</div>
<script type="text/javascript">
  <!--
  
  /* Outputs a link to call replyToComment(); used to reduce HTML output */
  function addReplyLink(id, real_id) {
      /* XXX this should really be updated to use the DOM Core's
       * createElement, but finding a container isn't trivial.
       */
        document.write('[<a href="#add_comment" onclick="replyToComment(' + 
                       id + ',' + real_id + ');">reply<' + '/a>]');
  }

  /* Adds the reply text to the `comment' textarea */
  function replyToComment(id, real_id) {
      var prefix = "(In reply to comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);

        /* make sure we split on all newlines -- IE or Moz use \r and \n
         * respectively.
         */
        text = text.split(/\r|\n/);

        for (var i=0; i < text.length; i++) {
            replytext += "> " + text[i] + "\n"; 
        }

        replytext = prefix + replytext + "\n";


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      textarea.value += replytext;

      textarea.focus();
  }

  if (typeof Node == 'undefined') {
      /* MSIE doesn't define Node, so provide a compatibility object */
      window.Node = {
          TEXT_NODE: 3,
          ENTITY_REFERENCE_NODE: 5
      };
  }

  /* Concatenates all text from element's childNodes. This is used
   * instead of innerHTML because we want the actual text (and
   * innerText is non-standard).
   */
  function getText(element) {
      var child, text = "";
      for (var i=0; i < element.childNodes.length; i++) {
          child = element.childNodes[i];
          var type = child.nodeType;
          if (type == Node.TEXT_NODE || type == Node.ENTITY_REFERENCE_NODE) {
              text += child.nodeValue;
          } else {
              /* recurse into nodes of other types */
              text += getText(child);
          }
      }
      return text;
  }


  //-->
  </script>

<form name="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2014-12-15 16:20:43">
  <input type="hidden" name="longdesclength" value="9">
  <input type="hidden" name="id" value="352">
  <input type="hidden" name="token" value="1483479781-e55ffd813a134edfa71eff5385d0aedc">
<div class="bz_alias_short_desc_container edit_form">
     <a href="show_bug.cgi?id=352">
        <b>Bug&nbsp;352</b></a> - 
     <span id="summary_alias_container" class="bz_default_hidden"> 
      <span id="short_desc_nonedit_display">Postgres HEAD refactored INT64_FORMAT out of pg_config.h</span>
     </span>
  
       
    <div id="summary_alias_input">
      <table id="summary">  
        
        <tr>
          <td>
            <label accesskey="s" for="short_desc"><u>S</u>ummary</label>:
          </td>
          <td>Postgres HEAD refactored INT64_FORMAT out of pg_config.h
          </td>
        </tr>
      </table>
    </div>
  </div>
  <script type="text/javascript">
    hideAliasAndSummary('Postgres HEAD refactored INT64_FORMAT out of pg_config.h', '');
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <td class="field_label">
      <b><a href="page.cgi?id=fields.html#status">Status</a></b>:
    </td>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr>
<th class="field_label "
      id="field_label_product">
        <a href="describecomponents.cgi">Product:</a>
  </th>

<td class="field_value "
    id="field_container_product" >Slony-I</td>
    </tr>
        
    
    
    <tr>
      <td class="field_label">
        <label for="component" accesskey="m">
          <b><a href="describecomponents.cgi?product=Slony-I">
            Co<u>m</u>ponent</a>:
          </b>
        </label>
      </td><td>slon
  </td>
    </tr>
    <tr>
      <td class="field_label">
        <label for="version"><b>Version</b></label>:
      </td>
<td>devel
  </td>
    </tr>
        
    
        
    <tr>
      <td class="field_label">
        <label for="rep_platform" accesskey="h"><b>Platform</b></label>:
      </td>
      <td class="field_value">All
       All
       <script type="text/javascript">
         assignToDefaultOnChange(['product', 'component']);
       </script>
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <td class="field_label">
        <label for="priority" accesskey="i">
          <b><a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></b></label>:
      </td>
      <td>low
       major
      </td>
    </tr>            
          
          <tr>
      <td class="field_label">
        <b><a href="page.cgi?id=fields.html#assigned_to">Assigned To</a></b>:
      </td>
      <td><span class="vcard"><span class="fn">Christopher Browne</span>
</span>
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr>
    <td class="field_label">
      <label for="bug_file_loc" accesskey="u"><b>
          <u>U</u>RL</b></label>:
    </td>
    <td>
      <span id="bz_url_input_area">
          <a href=""></a>
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr><th class="field_label">
    <label for="dependson">Depends&nbsp;on</label>:
  </th>
  <td>    
    <span id="dependson_input_area">
    </span>
    
  </td>
  </tr>
  
  <tr><th class="field_label">
    <label for="blocked" accesskey="b"><u>B</u>locks</label>:
  </th>
  <td>    
    <span id="blocked_input_area">
    </span>
    
  </td>
  
  <tr>
    <th>&nbsp;</th>
  
    <td colspan="2" align="left" id="show_dependency_tree_or_graph">
      Show dependency <a href="showdependencytree.cgi?id=352&amp;hide_resolved=1">tree</a>
  
        /&nbsp;<a href="showdependencygraph.cgi?id=352">graph</a>
    </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table cellpadding="3" cellspacing="1">
        <tr>
    <td class="field_label">
      <b>Reported</b>:
    </td>
    <td>2014-10-02 08:43 PDT by <span class="vcard"><span class="fn">Christopher Browne</span>
</span>
    </td>
  </tr>
  
  <tr>
    <td class="field_label">
      <b> Modified</b>:
    </td>
    <td>2014-12-15 16:20 PST 
      (<a href="show_activity.cgi?id=352">History</a>)
    </td>
  
  </tr>
         <tr>
      <td class="field_label">
        <label for="newcc" accesskey="a"><b>CC List</b>:</label>
      </td>
      <td>1 
          user
        <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
          (<a href="#" id="cc_edit_area_showhide">show</a>)
        </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" name="cc" multiple="multiple" size="5">
                <option value="slony1-bugs">slony1-bugs</option>
            </select>
        </div>
        <script type="text/javascript">
          hideEditableField( 'cc_edit_area_showhide_container', 
                             'cc_edit_area', 
                             'cc_edit_area_showhide', 
                             '', 
                             '');  
        </script>
      </td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
      id="field_label_see_also">
        <a href="page.cgi?id=fields.html#see_also">See Also:</a>
  </th>

<td class="field_value "
    id="field_container_see_also" ></td>
    </tr> 
         
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
         
                

        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  
  


<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
    }
    else {
        link.innerHTML = "Hide Obsolete";
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table" cellspacing="0" cellpadding="4">
  <tr>
    <th colspan="2" align="left">
      <a name="a0" id="a0">Attachments</a>
    </th>
  </tr>


      <tr class="">
        <td valign="top">
            <a name="a1" href="attachment.cgi?id=205"
               title="View the content of the attachment">
          <b>Define INT64_FORMAT if not provided by pg_config.h</b></a>

          <span class="bz_attach_extra_info">
              (1.03 KB,
                patch)

            <br>
            <a href="#attach_205"
               title="Go to the comment associated with the attachment">2014-10-02 08:45 PDT</a>,
<span class="vcard"><span class="fn">Christopher Browne</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=205&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=205&amp;action=diff">Diff</a>
        </td>
      </tr>
      <tr class="">
        <td valign="top">
            <a name="a2" href="attachment.cgi?id=206"
               title="View the content of the attachment">
          <b>include postgres_fe (DRAFT)</b></a>

          <span class="bz_attach_extra_info">
              (3.18 KB,
                patch)

            <br>
            <a href="#attach_206"
               title="Go to the comment associated with the attachment">2014-10-22 17:57 PDT</a>,
<span class="vcard"><span class="fn">Steve Singer</span>
</span>
          </span>
        </td>


        <td valign="top">
          <a href="attachment.cgi?id=206&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=206&amp;action=diff">Diff</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="2">
        <span class="bz_attach_view_hide">
        </span>
      <a href="attachment.cgi?bugid=352&amp;action=enter">Add an attachment</a>
      (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>




  <br>
  <table cellpadding="1" cellspacing="1">
    <tr>
      <td id="comment_status_commit">
        <!-- The table keeps the commit button aligned with the box. -->
        <a name="add_comment"></a>
          <fieldset>
            <legend>Note</legend>
            <p>
              You need to
              <a href="show_bug.cgi?id=352&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </p>
          </fieldset>
        
        <hr>
        <div id="comments"><script type="text/javascript">
  <!--
  function updateCommentPrivacy(checkbox, id) {
    var comment_elem = document.getElementById('comment_text_'+id).parentNode;
    if (checkbox.checked) {
      if (!comment_elem.className.match('bz_private')) {
        comment_elem.className = comment_elem.className.concat(' bz_private');
      }
    }
    else {
      comment_elem.className =
        comment_elem.className.replace(/(\s*|^)bz_private(\s*|$)/, '$2');
    }
  }

  /* The functions below expand and collapse comments  */

  function toggle_comment_display(link, comment_id) {
    var comment = document.getElementById('comment_text_' + comment_id);
    var re = new RegExp(/\bcollapsed\b/);
    if (comment.className.match(re))
        expand_comment(link, comment);
    else
        collapse_comment(link, comment);
  }

  function toggle_all_comments(action) {
    var num_comments = 9;

    // If for some given ID the comment doesn't exist, this doesn't mean
    // there are no more comments, but that the comment is private and
    // the user is not allowed to view it.

    for (var id = 0; id < num_comments; id++) {
        var comment = document.getElementById('comment_text_' + id);
        if (!comment)
            continue;

        var link = document.getElementById('comment_link_' + id);
        if (action == 'collapse')
            collapse_comment(link, comment);
        else
            expand_comment(link, comment);
    }
  }

  function collapse_comment(link, comment) {
    link.innerHTML = "[+]";
    link.title = "Expand the comment.";
    YAHOO.util.Dom.addClass(comment, 'collapsed');
  }

  function expand_comment(link, comment) {
    link.innerHTML = "[-]";
    link.title = "Collapse the comment";
    YAHOO.util.Dom.removeClass(comment, 'collapsed');
  }

  /* This way, we are sure that browsers which do not support JS
   * won't display this link  */

  function addCollapseLink(count) {
    document.write(' <a href="#" class="bz_collapse_comment"' +
                   ' id="comment_link_' + count +
                   '" onclick="toggle_comment_display(this, ' +  count +
                   '); return false;" title="Collapse the comment.">[-]<\/a> ');
  }
  //-->
  </script>








<div class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">



        <span class="bz_comment_number">
          <a name="c0" 
             href="show_bug.cgi?id=352#c0">Description</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Christopher Browne</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-10-02 08:43:56 PDT
        </span>
      </div>



<pre class="bz_comment_text" >In commit ce486056ecd28050f367894a2b5aad3656d37511, INT64_FORMAT was removed
from 
pg_config.h, added to c.h, which is inappropriate for us to #include in Slony.</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c1" 
             href="show_bug.cgi?id=352#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Christopher Browne</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-10-02 08:45:55 PDT
        </span>
      </div>



<pre class="bz_comment_text" ><span class=""><a href="attachment.cgi?id=205" name="attach_205" title="Define INT64_FORMAT if not provided by pg_config.h">Created an attachment (id=205)</a> <a href="attachment.cgi?id=205&amp;action=edit" title="Define INT64_FORMAT if not provided by pg_config.h">[details]</a></span>
Define INT64_FORMAT if not provided by pg_config.h

This approach requires no configure changes.</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c2" 
             href="show_bug.cgi?id=352#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Steve Singer</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-10-22 17:57:49 PDT
        </span>
      </div>



<pre class="bz_comment_text" ><span class=""><a href="attachment.cgi?id=206" name="attach_206" title="include postgres_fe (DRAFT)">Created an attachment (id=206)</a> <a href="attachment.cgi?id=206&amp;action=edit" title="include postgres_fe (DRAFT)">[details]</a></span>
include postgres_fe (DRAFT)

This is another approach we could take
include postgres_fe.h which picks up the location that INT64_FORMAT has been
moved to.

Including postgres_fe.h mean that we need to use the SERVER include paths when
building slonik and slon.  We do this anyway if we are building with pgport (so
to build with this patch do --with-pgport on the configure line)

If we go with that approach we'd make both pgport and non-pgport builds use
those</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c3" 
             href="show_bug.cgi?id=352#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Christopher Browne</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-11-26 12:12:02 PST
        </span>
      </div>



<pre class="bz_comment_text" >Apply to master, 2.2, see if it is apropos for 2.1.</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c4" 
             href="show_bug.cgi?id=352#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Christopher Browne</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-12-11 14:40:05 PST
        </span>
      </div>



<pre class="bz_comment_text" >It seems there's more that has broken here; the test, on HEAD, for
set_config_option has broken, it does not properly detect whether the function
has 6 or 7 options (7 is correct, as it happens).

Seems like #includes have broken slony a wee bit further.  Investigation
ongoing...</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c5" 
             href="show_bug.cgi?id=352#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Christopher Browne</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-12-12 15:39:00 PST
        </span>
      </div>



<pre class="bz_comment_text" >Note also that set_config_option() has had an extra parameter added to it in
HEAD (&quot;someday to become 9.5 or so&quot;).

Adding an autoconfigure handler for the &quot;8 parms&quot; case.</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c6" 
             href="show_bug.cgi?id=352#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Christopher Browne</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-12-12 15:51:09 PST
        </span>
      </div>



<pre class="bz_comment_text" >Looks like there's further entertainment...

Compiling the log trigger stuff has some curious warnings:

gcc -g -O2 -Wall -Wmissing-prototypes -Wmissing-declarations -I../.. -fpic
-I/var/lib/postgresql/dbs/postgresql-HEAD/include/server/ -c -o slony1_funcs.o
slony1_funcs.c
In file included from
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/postgres.h:48:0,
                 from slony1_funcs.c:13:
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/utils/elog.h:150:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
 __attribute__((format(PG_PRINTF_ATTRIBUTE, 1, 2)));
 ^
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/utils/elog.h:156:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
 __attribute__((format(PG_PRINTF_ATTRIBUTE, 1, 2)));
 ^
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/utils/elog.h:164:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
 __attribute__((format(PG_PRINTF_ATTRIBUTE, 2, 4)));
 ^
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/utils/elog.h:164:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/utils/elog.h:170:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
 __attribute__((format(PG_PRINTF_ATTRIBUTE, 1, 2)));
 ^
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/utils/elog.h:176:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
 __attribute__((format(PG_PRINTF_ATTRIBUTE, 1, 2)));
 ^
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/utils/elog.h:182:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
 __attribute__((format(PG_PRINTF_ATTRIBUTE, 1, 2)));
 ^
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/utils/elog.h:190:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
 __attribute__((format(PG_PRINTF_ATTRIBUTE, 2, 4)));
 ^
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/utils/elog.h:190:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/utils/elog.h:198:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
 __attribute__((format(PG_PRINTF_ATTRIBUTE, 2, 4)));
 ^
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/utils/elog.h:198:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/utils/elog.h:204:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
 __attribute__((format(PG_PRINTF_ATTRIBUTE, 1, 2)));
 ^
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/utils/elog.h:221:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
 __attribute__((format(PG_PRINTF_ATTRIBUTE, 1, 2)));
 ^
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/utils/elog.h:280:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
 __attribute__((format(PG_PRINTF_ATTRIBUTE, 2, 3)));
 ^
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/utils/elog.h:290:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
 __attribute__((format(PG_PRINTF_ATTRIBUTE, 1, 2)));
 ^
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/utils/elog.h:466:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
 __attribute__((format(PG_PRINTF_ATTRIBUTE, 1, 2)));
 ^
In file included from
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/postgres.h:49:0,
                 from slony1_funcs.c:13:
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/utils/palloc.h:112:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
 __attribute__((format(PG_PRINTF_ATTRIBUTE, 1, 2)));
 ^
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/utils/palloc.h:115:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
 __attribute__((format(PG_PRINTF_ATTRIBUTE, 3, 0)));
 ^
In file included from
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/nodes/plannodes.h:18:0,
                 from
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/nodes/execnodes.h:21,
                 from
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/executor/execdesc.h:18,
                 from
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/utils/portal.h:50,
                 from
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/executor/spi.h:18,
                 from slony1_funcs.c:27:
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/lib/stringinfo.h:98:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
 __attribute__((format(PG_PRINTF_ATTRIBUTE, 2, 3)));
 ^
/var/lib/postgresql/dbs/postgresql-HEAD/include/server/lib/stringinfo.h:111:1:
warning: 'PG_PRINTF_ATTRIBUTE' is an unrecognized format function type
[-Wformat=]
 __attribute__((format(PG_PRINTF_ATTRIBUTE, 2, 0)));
 ^
slony1_funcs.c: In function '_Slony_I_2_3_0_createEvent':
slony1_funcs.c:231:10: warning: variable 'buf_size' set but not used
[-Wunused-but-set-variable]
  size_t  buf_size;
          ^

And it seems as though this causes heartburn in terms of the inserts into the
target table not getting generated properly:


Dec 12 18:46:24 cbbrowne slon-slony_regress1-2[28360]: [205-1] INFO  
remoteWorkerThread_1: syncing set 1 with 4 table(s) from provider 1
Dec 12 18:46:24 cbbrowne postgres[28374]: [3-1] ERROR:  syntax error at or near
&quot;)&quot; at character 32
Dec 12 18:46:24 cbbrowne postgres[28374]: [3-2] QUERY:  INSERT INTO
&quot;public&quot;.&quot;table1&quot; () VALUES ();
Dec 12 18:46:24 cbbrowne postgres[28374]: [3-3] CONTEXT:  COPY sl_log_1, line
1: &quot;1#0113632#0111#0111#011public#011table1#011I#0110#011{}&quot;
Dec 12 18:46:24 cbbrowne postgres[28374]: [3-4] STATEMENT:  COPY
&quot;_slony_regress1&quot;.&quot;sl_log_1&quot; ( log_origin,
log_txid,log_tableid,log_actionseq,log_tablenspname, log_tablerelname,
log_cmdtype, log_cmdupdncols,log_cmdargs) FROM STDIN

That's definitely not the schema for public.table1...

slonyregress1@localhost-&gt;  \d table1
                         Table &quot;public.table1&quot;
 Column |  Type   |                      Modifiers                      
--------+---------+-----------------------------------------------------
 id     | integer | not null default nextval('table1_id_seq'::regclass)
 data   | text    | 
Indexes:
    &quot;table1_pkey&quot; PRIMARY KEY, btree (id)
Referenced by:
    TABLE &quot;table2&quot; CONSTRAINT &quot;table2_table1_id_fkey&quot; FOREIGN KEY (table1_id)
REFERENCES table1(id) ON UPDATE CASCADE ON DELETE CASCADE
Triggers:
    _slony_regress1_logtrigger AFTER INSERT OR DELETE OR UPDATE ON table1 FOR
EACH ROW EXECUTE PROCEDURE _slony_regress1.logtrigger('_slony_regress1', '1',
'k')
    _slony_regress1_truncatetrigger BEFORE TRUNCATE ON table1 FOR EACH
STATEMENT EXECUTE PROCEDURE _slony_regress1.log_truncate('1')
Disabled user triggers:
    _slony_regress1_denyaccess BEFORE INSERT OR DELETE OR UPDATE ON table1 FOR
EACH ROW EXECUTE PROCEDURE _slony_regress1.denyaccess('_slony_regress1')
    _slony_regress1_truncatedeny BEFORE TRUNCATE ON table1 FOR EACH STATEMENT
EXECUTE PROCEDURE _slony_regress1.deny_truncate()

Compare with how slony1_funcs.c gets built against PG 9.3:

gcc -g -O2 -Wall -Wmissing-prototypes -Wmissing-declarations -I../.. -fpic
-I/var/lib/postgresql/dbs/postgresql-9.3/include/server/ -c -o slony1_funcs.o
slony1_funcs.c
slony1_funcs.c: In function '_Slony_I_2_3_0_createEvent':
slony1_funcs.c:231:10: warning: variable 'buf_size' set but not used
[-Wunused-but-set-variable]
  size_t  buf_size;
          ^
The complaints about PG_PRINTF_ATTRIBUTE seem pretty significant, despite being
mere &quot;warnings&quot;.</pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c7" 
             href="show_bug.cgi?id=352#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Christopher Browne</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-12-12 15:55:21 PST
        </span>
      </div>



<pre class="bz_comment_text" >I'm looking at this in the following &quot;<span class="bz_closed"><a href="show_bug.cgi?id=352" title="RESOLVED FIXED - Postgres HEAD refactored INT64_FORMAT out of pg_config.h">bug352</a></span>&quot; branch.

<a href="https://github.com/cbbrowne/slony1-engine/tree/bug352">https://github.com/cbbrowne/slony1-engine/tree/bug352</a></pre>
    </div>
  <div class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a name="c8" 
             href="show_bug.cgi?id=352#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user"><span class="vcard"><span class="fn">Christopher Browne</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2014-12-15 16:20:43 PST
        </span>
      </div>



<pre class="bz_comment_text" >Fixed in HEAD:
&lt;<a href="http://git.postgresql.org/gitweb/?p=slony1-engine.git;a=commit;h=0a1958dc65290e32d98299642a0646741dfcce0e">http://git.postgresql.org/gitweb/?p=slony1-engine.git;a=commit;h=0a1958dc65290e32d98299642a0646741dfcce0e</a>&gt;

Also, 2.2 STABLE 
&lt;<a href="http://git.postgresql.org/gitweb/?p=slony1-engine.git;a=commit;h=29a1cd98a03964b35a1451b10a448392392c05ff">http://git.postgresql.org/gitweb/?p=slony1-engine.git;a=commit;h=29a1cd98a03964b35a1451b10a448392392c05ff</a>&gt;

Also, 2.1 STABLE
&lt;<a href="http://git.postgresql.org/gitweb/?p=slony1-engine.git;a=commit;h=15962cbd3e9c44b5418a5ed6138843a7a4ed4f81">http://git.postgresql.org/gitweb/?p=slony1-engine.git;a=commit;h=15962cbd3e9c44b5418a5ed6138843a7a4ed4f81</a>&gt;</pre>
    </div>
        </div>
        
      </td>
    </tr>
  </table>
</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=352">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=352">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=352">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>        


<div class="navigation">
  
  
  <i><font color="#777777">First</font></i>
  <i><font color="#777777">Last</font></i>
  <i><font color="#777777">Prev</font></i>
  <i><font color="#777777">Next</font></i>
  &nbsp;&nbsp;
  <i><font color="#777777">No search results available</font></i>
</div>

<br>
</div>



<div id="footer">
  <div class="intro"></div>




<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch">
    <input class="btn" type="submit" value="Find" id="find_bottom"></form></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li></li>


  <li>
        <span class="separator">| </span>
        <a href="docs/en/html/bug_page.html" target="_blank">Help</a>
      </li>
    
      <li id="new_account_container_bottom">
        <span class="separator">| </span>
        <a href="createaccount.cgi">New&nbsp;Account</a>
      </li>

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="?GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>
  <form action="http://www.slony.info/bugzilla/show_bug.cgi?id=352" method="POST" 
        class="mini_login bz_default_hidden"
        id="mini_login_bottom"
        onsubmit="return check_mini_login_fields( '_bottom' );"
  >
    <input id="Bugzilla_login_bottom" 
           class="bz_login"
           name="Bugzilla_login"
           onfocus="mini_login_on_focus('_bottom')"
    >
    <input class="bz_password" 
           id="Bugzilla_password_bottom" 
           name="Bugzilla_password"
           type="password"
    >
    <input class="bz_password bz_default_hidden bz_mini_login_help" type="text" 
           id="Bugzilla_password_dummy_bottom" value="password"
           onfocus="mini_login_on_focus('_bottom')"
    >
    <input type="submit" name="GoAheadAndLogIn" value="Log in" 
            id="log_in_bottom">
    <script type="text/javascript">
      mini_login_constants = {
          "login" : "login",
          "warning" : "You must set the login and password before logging in."
      };
      
      if (YAHOO.env.ua.gecko || YAHOO.env.ua.ie || YAHOO.env.ua.opera) {
          YAHOO.util.Event.onDOMReady(function() {
              init_mini_login_form('_bottom');
          });
      }
      else {
          YAHOO.util.Event.on(window, 'load', function () {
              window.setTimeout(function() {
                  init_mini_login_form('_bottom');
              }, 200);
          });
    }
    </script>
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>
<li id="forgot_container_bottom">
  <span class="separator">| </span>
  <a id="forgot_link_bottom" href="?GoAheadAndLogIn=1#forgot"
     onclick="return show_forgot_form('_bottom')">Forgot Password</a>
  <form action="token.cgi" method="post" id="forgot_form_bottom"
        class="mini_forgot bz_default_hidden">
    <label>Login: <input type="text" name="loginname" size="20"></label>
    <input id="forgot_button_bottom" value="Reset Password" 
           type="submit">
    <input type="hidden" name="a" value="reqpw">
    <a href="#" onclick="return hide_forgot_form('_bottom')">[x]</a>
  </form>
</li>
</ul>
  </li>

  
    

  


  
</ul>

  <div class="outro"></div>
</div>

</body>
</html>