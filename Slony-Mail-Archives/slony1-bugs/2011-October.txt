From bugzilla-daemon at main.slony.info  Mon Oct  3 16:21:52 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Mon,  3 Oct 2011 16:21:52 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 237] drop set does not remove truncate triggers
In-Reply-To: <bug-237-4@http.www.slony.info/bugzilla/>
References: <bug-237-4@http.www.slony.info/bugzilla/>
Message-ID: <20111003232152.7C74E290E59@main.slony.info>

http://www.slony.info/bugzilla/show_bug.cgi?id=237

Jan Wieck <janwieck at yahoo.com> changed:

           What    |Removed                     |Added
----------------------------------------------------------------------------
         AssignedTo|slony1-bugs at lists.slony.inf |cbbrowne at ca.afilias.info
                   |o                           |
             Status|NEW                         |ASSIGNED
                URL|                            |https://github.com/wieck/sl
                   |                            |ony1-engine/commit/0a80afee
                   |                            |7256fa5ed4d5d635a6fb5516d9b
                   |                            |13c4c

--- Comment #1 from Jan Wieck <janwieck at yahoo.com> 2011-10-03 16:21:52 PDT ---
Please review patch.

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

From bugzilla-daemon at main.slony.info  Tue Oct  4 08:23:46 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Tue,  4 Oct 2011 08:23:46 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 242] New: Unable to install slony 2.1 RC1
Message-ID: <bug-242-4@http.www.slony.info/bugzilla/>

http://www.slony.info/bugzilla/show_bug.cgi?id=242

           Summary: Unable to install slony 2.1 RC1
           Product: Slony-I
           Version: devel
          Platform: PC
        OS/Version: Linux
            Status: NEW
          Severity: critical
          Priority: low
         Component: core scripts
        AssignedTo: slony1-bugs at lists.slony.info
        ReportedBy: andre.bolinhas at hotmail.com
                CC: slony1-bugs at lists.slony.info
   Estimated Hours: 0.0


Hi,

I can not install slony 2.1 rc1 on my ubuntu.

I get this error on "make all"
root at webmail:~/slony1-2.1.0.rc1# make all
make[1]: Entering directory `/root/slony1-2.1.0.rc1/src'
make[2]: Entering directory `/root/slony1-2.1.0.rc1/src/parsestatements'
./test-scanner < /dev/null > emptytestresult.log
./test-scanner < ./test_sql.sql > test_sql.log
./test-scanner < ./cstylecomments.sql > cstylecomments.log
make[2]: Leaving directory `/root/slony1-2.1.0.rc1/src/parsestatements'
make[2]: Entering directory `/root/slony1-2.1.0.rc1/src/slon'
make[2]: Nothing to be done for `all'.
make[2]: Leaving directory `/root/slony1-2.1.0.rc1/src/slon'
make[2]: Entering directory `/root/slony1-2.1.0.rc1/src/slonik'
make[2]: Nothing to be done for `all'.
make[2]: Leaving directory `/root/slony1-2.1.0.rc1/src/slonik'
make[2]: Entering directory `/root/slony1-2.1.0.rc1/src/backend'
gcc -g -O2 -Wall -Wmissing-prototypes -Wmissing-declarations -I../.. -fpic
-I/usr/include/postgresql/ -I/usr/include/postgresql/8.4/server/  -c -o
slony1_funcs.o slony1_funcs.c
slony1_funcs.c:23:23: error: miscadmin.h: No such file or directory
slony1_funcs.c:24:29: error: nodes/makefuncs.h: No such file or directory
slony1_funcs.c:25:29: error: parser/keywords.h: No such file or directory
slony1_funcs.c:26:31: error: parser/parse_type.h: No such file or directory
slony1_funcs.c:27:26: error: executor/spi.h: No such file or directory
slony1_funcs.c:28:30: error: commands/trigger.h: No such file or directory
slony1_funcs.c:29:28: error: commands/async.h: No such file or directory
slony1_funcs.c:30:33: error: catalog/pg_operator.h: No such file or directory
slony1_funcs.c:32:25: error: access/xact.h: No such file or directory
slony1_funcs.c:33:28: error: access/transam.h: No such file or directory
slony1_funcs.c:34:28: error: utils/builtins.h: No such file or directory
slony1_funcs.c:36:23: error: utils/guc.h: No such file or directory
slony1_funcs.c:37:23: error: utils/rel.h: No such file or directory
slony1_funcs.c:38:28: error: utils/relcache.h: No such file or directory
slony1_funcs.c:45:31: error: parser/parse_oper.h: No such file or directory
slony1_funcs.c:59: warning: data definition has no type or storage class
slony1_funcs.c:59: warning: type defaults to ?int? in declaration of
?PG_FUNCTION_INFO_V1?
slony1_funcs.c:59: warning: parameter names (without types) in function
declaration
slony1_funcs.c:60: warning: data definition has no type or storage class
slony1_funcs.c:60: warning: type defaults to ?int? in declaration of
?PG_FUNCTION_INFO_V1?
slony1_funcs.c:60: warning: parameter names (without types) in function
declaration
slony1_funcs.c:61: warning: data definition has no type or storage class
slony1_funcs.c:61: warning: type defaults to ?int? in declaration of
?PG_FUNCTION_INFO_V1?
slony1_funcs.c:61: warning: parameter names (without types) in function
declaration
slony1_funcs.c:63: warning: data definition has no type or storage class
slony1_funcs.c:63: warning: type defaults to ?int? in declaration of
?PG_FUNCTION_INFO_V1?
slony1_funcs.c:63: warning: parameter names (without types) in function
declaration
slony1_funcs.c:64: warning: data definition has no type or storage class
slony1_funcs.c:64: warning: type defaults to ?int? in declaration of
?PG_FUNCTION_INFO_V1?
slony1_funcs.c:64: warning: parameter names (without types) in function
declaration
slony1_funcs.c:65: warning: data definition has no type or storage class
slony1_funcs.c:65: warning: type defaults to ?int? in declaration of
?PG_FUNCTION_INFO_V1?
slony1_funcs.c:65: warning: parameter names (without types) in function
declaration
slony1_funcs.c:66: warning: data definition has no type or storage class
slony1_funcs.c:66: warning: type defaults to ?int? in declaration of
?PG_FUNCTION_INFO_V1?
slony1_funcs.c:66: warning: parameter names (without types) in function
declaration
slony1_funcs.c:67: warning: data definition has no type or storage class
slony1_funcs.c:67: warning: type defaults to ?int? in declaration of
?PG_FUNCTION_INFO_V1?
slony1_funcs.c:67: warning: parameter names (without types) in function
declaration
slony1_funcs.c:69: warning: data definition has no type or storage class
slony1_funcs.c:69: warning: type defaults to ?int? in declaration of
?PG_FUNCTION_INFO_V1?
slony1_funcs.c:69: warning: parameter names (without types) in function
declaration
slony1_funcs.c:70: warning: data definition has no type or storage class
slony1_funcs.c:70: warning: type defaults to ?int? in declaration of
?PG_FUNCTION_INFO_V1?
slony1_funcs.c:70: warning: parameter names (without types) in function
declaration
slony1_funcs.c:71: warning: data definition has no type or storage class
slony1_funcs.c:71: warning: type defaults to ?int? in declaration of
?PG_FUNCTION_INFO_V1?
slony1_funcs.c:71: warning: parameter names (without types) in function
declaration
slony1_funcs.c:73: warning: parameter names (without types) in function
declaration
slony1_funcs.c:74: warning: parameter names (without types) in function
declaration
slony1_funcs.c:75: warning: parameter names (without types) in function
declaration
slony1_funcs.c:77: warning: parameter names (without types) in function
declaration
slony1_funcs.c:78: warning: parameter names (without types) in function
declaration
slony1_funcs.c:79: warning: parameter names (without types) in function
declaration
slony1_funcs.c:80: warning: parameter names (without types) in function
declaration
slony1_funcs.c:81: warning: parameter names (without types) in function
declaration
slony1_funcs.c:83: warning: parameter names (without types) in function
declaration
slony1_funcs.c:84: warning: parameter names (without types) in function
declaration
slony1_funcs.c:86: warning: parameter names (without types) in function
declaration
slony1_funcs.c:139: warning: no previous prototype for ?_Slony_I_createEvent?
slony1_funcs.c: In function ?_Slony_I_createEvent?:
slony1_funcs.c:141: warning: implicit declaration of function
?GetCurrentTransactionId?
slony1_funcs.c:156: error: ?SerializableSnapshot? undeclared (first use in this
function)
slony1_funcs.c:156: error: (Each undeclared identifier is reported only once
slony1_funcs.c:156: error: for each function it appears in.)
slony1_funcs.c:160: warning: implicit declaration of function ?SPI_connect?
slony1_funcs.c:167: warning: implicit declaration of function ?PG_GETARG_NAME?
slony1_funcs.c:168: warning: passing argument 1 of ?getClusterStatus? makes
pointer from integer without a cast
slony1_funcs.c:131: note: expected ?Name? but argument is of type ?int?
slony1_funcs.c:175: warning: implicit declaration of function
?TransactionIdEquals?
slony1_funcs.c:185: warning: implicit declaration of function ?PG_NARGS?
slony1_funcs.c:185: warning: implicit declaration of function ?PG_ARGISNULL?
slony1_funcs.c:192: warning: implicit declaration of function ?PG_GETARG_DATUM?
slony1_funcs.c:198: warning: implicit declaration of function ?SPI_execp?
slony1_funcs.c:205: error: ?SPI_processed? undeclared (first use in this
function)
slony1_funcs.c:207: warning: implicit declaration of function ?SPI_getbinval?
slony1_funcs.c:207: error: ?SPI_tuptable? undeclared (first use in this
function)
slony1_funcs.c:216: warning: implicit declaration of function
?DirectFunctionCall1?
slony1_funcs.c:216: error: ?textout? undeclared (first use in this function)
slony1_funcs.c:228: warning: implicit declaration of function ?SPI_finish?
slony1_funcs.c:230: warning: implicit declaration of function ?PG_RETURN_INT64?
slony1_funcs.c: At top level:
slony1_funcs.c:245: warning: no previous prototype for
?_Slony_I_getLocalNodeId?
slony1_funcs.c: In function ?_Slony_I_getLocalNodeId?:
slony1_funcs.c:253: warning: passing argument 1 of ?getClusterStatus? makes
pointer from integer without a cast
slony1_funcs.c:131: note: expected ?Name? but argument is of type ?int?
slony1_funcs.c:257: warning: implicit declaration of function ?PG_RETURN_INT32?
slony1_funcs.c: At top level:
slony1_funcs.c:269: warning: no previous prototype for
?_Slony_I_getModuleVersion?
slony1_funcs.c: In function ?_Slony_I_getModuleVersion?:
slony1_funcs.c:280: warning: implicit declaration of function
?PG_RETURN_TEXT_P?
slony1_funcs.c: At top level:
slony1_funcs.c:285: warning: no previous prototype for ?_Slony_I_logTrigger?
slony1_funcs.c: In function ?_Slony_I_logTrigger?:
slony1_funcs.c:289: error: ?TriggerData? undeclared (first use in this
function)
slony1_funcs.c:289: error: ?tg? undeclared (first use in this function)
slony1_funcs.c:302: error: ?SessionReplicationRole? undeclared (first use in
this function)
slony1_funcs.c:302: error: ?SESSION_REPLICATION_ROLE_ORIGIN? undeclared (first
use in this function)
slony1_funcs.c:308: warning: implicit declaration of function
?CALLED_AS_TRIGGER?
slony1_funcs.c:308: error: ?fcinfo? undeclared (first use in this function)
slony1_funcs.c:310: error: expected expression before ?)? token
slony1_funcs.c:315: warning: implicit declaration of function
?TRIGGER_FIRED_AFTER?
slony1_funcs.c:317: warning: implicit declaration of function
?TRIGGER_FIRED_FOR_ROW?
slony1_funcs.c:331: error: ?namein? undeclared (first use in this function)
slony1_funcs.c:355: error: ?SPI_processed? undeclared (first use in this
function)
slony1_funcs.c:358: error: ?SPI_tuptable? undeclared (first use in this
function)
slony1_funcs.c:360: warning: implicit declaration of function
?SPI_freetuptable?
slony1_funcs.c:386: warning: implicit declaration of function
?TRIGGER_FIRED_BY_INSERT?
slony1_funcs.c:388: error: ?HeapTuple? undeclared (first use in this function)
slony1_funcs.c:388: error: expected ?;? before ?new_row?
slony1_funcs.c:389: error: ?TupleDesc? undeclared (first use in this function)
slony1_funcs.c:389: error: expected ?;? before ?tupdesc?
slony1_funcs.c:416: error: ?tupdesc? undeclared (first use in this function)
slony1_funcs.c:419: warning: implicit declaration of function ?SPI_fname?
slony1_funcs.c:459: warning: implicit declaration of function
?GetConfigOptionByName?
slony1_funcs.c:459: warning: assignment makes pointer from integer without a
cast
slony1_funcs.c:461: warning: implicit declaration of function
?set_config_option?
slony1_funcs.c:461: error: ?PGC_USERSET? undeclared (first use in this
function)
slony1_funcs.c:461: error: ?PGC_S_SESSION? undeclared (first use in this
function)
slony1_funcs.c:471: warning: implicit declaration of function ?SPI_getvalue?
slony1_funcs.c:471: error: ?new_row? undeclared (first use in this function)
slony1_funcs.c:512: warning: implicit declaration of function
?TRIGGER_FIRED_BY_UPDATE?
slony1_funcs.c:514: error: expected ?;? before ?old_row?
slony1_funcs.c:515: error: expected ?;? before ?new_row?
slony1_funcs.c:516: error: expected ?;? before ?tupdesc?
slony1_funcs.c:548: error: ?old_row? undeclared (first use in this function)
slony1_funcs.c:564: error: ?FmgrInfo? undeclared (first use in this function)
slony1_funcs.c:564: error: ?opr_finfo_p? undeclared (first use in this
function)
slony1_funcs.c:582: error: expected ?;? before ?opr_finfo?
slony1_funcs.c:584: warning: implicit declaration of function
?compatible_oper_funcid?
slony1_funcs.c:584: warning: implicit declaration of function ?makeList1?
slony1_funcs.c:584: warning: implicit declaration of function ?makeString?
slony1_funcs.c:585: warning: implicit declaration of function ?SPI_gettypeid?
slony1_funcs.c:589: warning: implicit declaration of function ?fmgr_info?
slony1_funcs.c:589: error: ?opr_finfo? undeclared (first use in this function)
slony1_funcs.c:601: warning: implicit declaration of function ?FunctionCall2?
slony1_funcs.c:625: warning: assignment makes pointer from integer without a
cast
slony1_funcs.c:757: warning: implicit declaration of function
?TRIGGER_FIRED_BY_DELETE?
slony1_funcs.c:759: error: expected ?;? before ?old_row?
slony1_funcs.c:760: error: expected ?;? before ?tupdesc?
slony1_funcs.c: At top level:
slony1_funcs.c:843: warning: no previous prototype for ?_Slony_I_denyAccess?
slony1_funcs.c: In function ?_Slony_I_denyAccess?:
slony1_funcs.c:845: error: ?TriggerData? undeclared (first use in this
function)
slony1_funcs.c:845: error: ?tg? undeclared (first use in this function)
slony1_funcs.c:850: error: ?fcinfo? undeclared (first use in this function)
slony1_funcs.c:852: error: expected expression before ?)? token
slony1_funcs.c:857: warning: implicit declaration of function
?TRIGGER_FIRED_BEFORE?
slony1_funcs.c:875: error: ?SessionReplicationRole? undeclared (first use in
this function)
slony1_funcs.c:875: error: ?SESSION_REPLICATION_ROLE_ORIGIN? undeclared (first
use in this function)
slony1_funcs.c: At top level:
slony1_funcs.c:890: warning: no previous prototype for ?_Slony_I_lockedSet?
slony1_funcs.c: In function ?_Slony_I_lockedSet?:
slony1_funcs.c:892: error: ?TriggerData? undeclared (first use in this
function)
slony1_funcs.c:892: error: ?tg? undeclared (first use in this function)
slony1_funcs.c:897: error: ?fcinfo? undeclared (first use in this function)
slony1_funcs.c:899: error: expected expression before ?)? token
slony1_funcs.c: At top level:
slony1_funcs.c:921: warning: no previous prototype for ?_Slony_I_killBackend?
slony1_funcs.c: In function ?_Slony_I_killBackend?:
slony1_funcs.c:927: warning: implicit declaration of function ?superuser?
slony1_funcs.c:930: warning: implicit declaration of function ?PG_GETARG_INT32?
slony1_funcs.c:931: warning: implicit declaration of function
?PG_GETARG_TEXT_P?
slony1_funcs.c:931: warning: assignment makes pointer from integer without a
cast
slony1_funcs.c: At top level:
slony1_funcs.c:975: warning: no previous prototype for ?_Slony_I_seqtrack?
slony1_funcs.c: In function ?_Slony_I_seqtrack?:
slony1_funcs.c:984: warning: implicit declaration of function ?PG_GETARG_INT64?
slony1_funcs.c:1013: warning: implicit declaration of function ?PG_RETURN_NULL?
slony1_funcs.c: At top level:
slony1_funcs.c:1162: warning: no previous prototype for ?_slon_quote_ident?
slony1_funcs.c: In function ?_slon_quote_ident?:
slony1_funcs.c:1164: warning: initialization makes pointer from integer without
a cast
slony1_funcs.c: In function ?getClusterStatus?:
slony1_funcs.c:1196: error: ?TypeName? undeclared (first use in this function)
slony1_funcs.c:1196: error: ?txid_snapshot_typname? undeclared (first use in
this function)
slony1_funcs.c:1203: warning: implicit declaration of function
?DirectFunctionCall2?
slony1_funcs.c:1203: error: ?nameeq? undeclared (first use in this function)
slony1_funcs.c:1236: error: ?textout? undeclared (first use in this function)
slony1_funcs.c:1236: error: ?quote_ident? undeclared (first use in this
function)
slony1_funcs.c:1236: error: ?textin? undeclared (first use in this function)
slony1_funcs.c:1245: warning: implicit declaration of function ?SPI_exec?
slony1_funcs.c:1246: error: ?SPI_processed? undeclared (first use in this
function)
slony1_funcs.c:1248: error: ?SPI_tuptable? undeclared (first use in this
function)
slony1_funcs.c:1257: error: ?InvalidTransactionId? undeclared (first use in
this function)
slony1_funcs.c:1275: warning: implicit declaration of function ?makeNode?
slony1_funcs.c:1277: warning: implicit declaration of function ?lappend?
slony1_funcs.c:1277: error: ?NIL? undeclared (first use in this function)
slony1_funcs.c:1307: warning: implicit declaration of function ?SPI_saveplan?
slony1_funcs.c:1307: warning: implicit declaration of function ?SPI_prepare?
slony1_funcs.c:1307: warning: assignment makes pointer from integer without a
cast
slony1_funcs.c:1328: warning: assignment makes pointer from integer without a
cast
slony1_funcs.c:1362: warning: assignment makes pointer from integer without a
cast
slony1_funcs.c: In function ?prepareLogPlan?:
slony1_funcs.c:1402: warning: assignment makes pointer from integer without a
cast
slony1_funcs.c:1420: warning: assignment makes pointer from integer without a
cast
slony1_funcs.c: At top level:
slony1_funcs.c:1435: warning: no previous prototype for ?_Slony_I_resetSession?
slony1_funcs.c: In function ?_Slony_I_resetSession?:
slony1_funcs.c:1453: warning: implicit declaration of function ?SPI_freeplan?
slony1_funcs.c: At top level:
slony1_funcs.c:1479: warning: no previous prototype for ?_slon_decode_tgargs?
slony1_funcs.c: In function ?_slon_decode_tgargs?:
slony1_funcs.c:1483: error: ?ArrayType? undeclared (first use in this function)
slony1_funcs.c:1483: error: ?out_array? undeclared (first use in this function)
slony1_funcs.c:1485: warning: implicit declaration of function
?PG_GETARG_BYTEA_P?
slony1_funcs.c:1485: warning: initialization makes pointer from integer without
a cast
slony1_funcs.c:1490: warning: implicit declaration of function
?construct_empty_array?
slony1_funcs.c:1501: warning: implicit declaration of function ?array_set?
slony1_funcs.c:1521: warning: implicit declaration of function
?PG_RETURN_ARRAYTYPE_P?
make[2]: *** [slony1_funcs.o] Error 1
make[2]: Leaving directory `/root/slony1-2.1.0.rc1/src/backend'
make[1]: *** [all] Error 2
make[1]: Leaving directory `

I have postgres 8.4.

How can I fix this ?

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

From bugzilla-daemon at main.slony.info  Tue Oct  4 08:27:29 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Tue,  4 Oct 2011 08:27:29 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 242] Unable to install slony 2.1 RC1
In-Reply-To: <bug-242-4@http.www.slony.info/bugzilla/>
References: <bug-242-4@http.www.slony.info/bugzilla/>
Message-ID: <20111004152729.4044E290CED@main.slony.info>

http://www.slony.info/bugzilla/show_bug.cgi?id=242

abolinhas <andre.bolinhas at hotmail.com> changed:

           What    |Removed                     |Added
----------------------------------------------------------------------------
           Priority|low                         |urgent

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

From bugzilla-daemon at main.slony.info  Tue Oct  4 08:32:46 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Tue,  4 Oct 2011 08:32:46 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 242] Unable to install slony 2.1 RC1
In-Reply-To: <bug-242-4@http.www.slony.info/bugzilla/>
References: <bug-242-4@http.www.slony.info/bugzilla/>
Message-ID: <20111004153246.309FA290D99@main.slony.info>

http://www.slony.info/bugzilla/show_bug.cgi?id=242

--- Comment #1 from Steve Singer <ssinger at ca.afilias.info> 2011-10-04 08:32:46 PDT ---
What options did you pass to configure?

When you run pg_config what output does it give you?

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

From bugzilla-daemon at main.slony.info  Tue Oct  4 08:38:00 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Tue,  4 Oct 2011 08:38:00 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 242] Unable to install slony 2.1 RC1
In-Reply-To: <bug-242-4@http.www.slony.info/bugzilla/>
References: <bug-242-4@http.www.slony.info/bugzilla/>
Message-ID: <20111004153800.B4A21290D99@main.slony.info>

http://www.slony.info/bugzilla/show_bug.cgi?id=242

--- Comment #2 from abolinhas <andre.bolinhas at hotmail.com> 2011-10-04 08:38:00 PDT ---
What options did you pass to configure?
./configure -with-pgconfigdir=/usr/bin

When you run pg_config what output does it give you?
root at webmail:~/slony1-2.1.0.rc1# pg_config
BINDIR = /usr/lib/postgresql/8.4/bin
DOCDIR = /usr/share/doc/postgresql
HTMLDIR = /usr/share/doc/postgresql
INCLUDEDIR = /usr/include/postgresql
PKGINCLUDEDIR = /usr/include/postgresql
INCLUDEDIR-SERVER = /usr/include/postgresql/8.4/server
LIBDIR = /usr/lib
PKGLIBDIR = /usr/lib/postgresql/8.4/lib
LOCALEDIR = /usr/share/locale
MANDIR = /usr/share/postgresql/8.4/man
SHAREDIR = /usr/share/postgresql/8.4
SYSCONFDIR = /etc/postgresql-common
PGXS = /usr/lib/postgresql/8.4/lib/pgxs/src/makefiles/pgxs.mk
CONFIGURE = '--build=i486-linux-gnu' '--prefix=/usr'
'--includedir=/usr/include' '--mandir=/usr/share/man'
'--infodir=/usr/share/info' '--sysconfdir=/etc' '--localstatedir=/var'
'--libexecdir=/usr/lib/postgresql-8.4' '--disable-maintainer-mode'
'--disable-dependency-tracking' '--disable-silent-rules' '--srcdir=.'
'--mandir=/usr/share/postgresql/8.4/man'
'--with-docdir=/usr/share/doc/postgresql-doc-8.4'
'--sysconfdir=/etc/postgresql-common' '--datadir=/usr/share/postgresql/8.4'
'--bindir=/usr/lib/postgresql/8.4/bin' '--includedir=/usr/include/postgresql/'
'--enable-nls' '--enable-integer-datetimes' '--enable-thread-safety'
'--enable-debug' '--disable-rpath' '--with-tcl' '--with-perl' '--with-python'
'--with-pam' '--with-krb5' '--with-gssapi' '--with-openssl' '--with-libxml'
'--with-libxslt' '--with-ldap' '--with-ossp-uuid' '--with-gnu-ld'
'--with-tclconfig=/usr/lib/tcl8.5' '--with-tkconfig=/usr/lib/tk8.5'
'--with-includes=/usr/include/tcl8.5'
'--with-system-tzdata=/usr/share/zoneinfo' '--with-pgport=5432' 'CFLAGS=-g -O2
-g -Wall -O2 -fPIC' 'LDFLAGS= -Wl,--as-needed' 'build_alias=i486-linux-gnu'
'CPPFLAGS='
CC = gcc
CPPFLAGS = -D_GNU_SOURCE -I/usr/include/libxml2 -I/usr/include/tcl8.5
CFLAGS = -g -O2 -g -Wall -O2 -fPIC -Wall -Wmissing-prototypes -Wpointer-arith
-Wdeclaration-after-statement -Wendif-labels -fno-strict-aliasing -fwrapv -g
CFLAGS_SL = -fpic
LDFLAGS = -Wl,--as-needed -Wl,--as-needed
LDFLAGS_SL =
LIBS = -lpgport -lxslt -lxml2 -lpam -lssl -lcrypto -lkrb5 -lcom_err
-lgssapi_krb5 -lz -ledit -lcrypt -ldl -lm
VERSION = PostgreSQL 8.4.7

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

From bugzilla-daemon at main.slony.info  Tue Oct  4 11:01:33 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Tue,  4 Oct 2011 11:01:33 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 242] Unable to install slony 2.1 RC1
In-Reply-To: <bug-242-4@http.www.slony.info/bugzilla/>
References: <bug-242-4@http.www.slony.info/bugzilla/>
Message-ID: <20111004180133.DE0FD290E4D@main.slony.info>

http://www.slony.info/bugzilla/show_bug.cgi?id=242

--- Comment #3 from Steve Singer <ssinger at ca.afilias.info> 2011-10-04 11:01:34 PDT ---
What is in /usr/include/postgresql/8.4/server

Is the package postgresql-server-dev-8.4 installed on your system?

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

From bugzilla-daemon at main.slony.info  Tue Oct  4 14:50:20 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Tue,  4 Oct 2011 14:50:20 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 242] Unable to install slony 2.1 RC1
In-Reply-To: <bug-242-4@http.www.slony.info/bugzilla/>
References: <bug-242-4@http.www.slony.info/bugzilla/>
Message-ID: <20111004215020.1F973290E4D@main.slony.info>

http://www.slony.info/bugzilla/show_bug.cgi?id=242

--- Comment #4 from abolinhas <andre.bolinhas at hotmail.com> 2011-10-04 14:50:20 PDT ---
(In reply to comment #3)
> What is in /usr/include/postgresql/8.4/server
> 
> Is the package postgresql-server-dev-8.4 installed on your system?
Fixed by installing postgresql-server-dev-8.4
"All of Slony-I is successfully installed"

To close this topic can you help me to understand how to configure slony on my
schema ?

I want do this:
one-way replication/sync (master to slave).
I need to install slony on slave to ?
The master use postgres 8.4 and the slave use postgres 8.3, slony supports this
?
Slony supports schema changes (ddl), I mean if I create a new table on master,
slony will create automatically this table on slave ?

Can you post a example of slony configuration for what I want?

Best regards

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

From bugzilla-daemon at main.slony.info  Wed Oct  5 13:57:57 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Wed,  5 Oct 2011 13:57:57 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 239] Slony 1.2.22 and PG9.0 shows failure at
	failover
In-Reply-To: <bug-239-4@http.www.slony.info/bugzilla/>
References: <bug-239-4@http.www.slony.info/bugzilla/>
Message-ID: <20111005205757.57BB7290E51@main.slony.info>

http://www.slony.info/bugzilla/show_bug.cgi?id=239

Steve Singer <ssinger at ca.afilias.info> changed:

           What    |Removed                     |Added
----------------------------------------------------------------------------
         Resolution|                            |FIXED
             Status|ASSIGNED                    |RESOLVED

--- Comment #4 from Steve Singer <ssinger at ca.afilias.info> 2011-10-05 13:57:57 PDT ---
This fix has been committed
http://git.postgresql.org/gitweb?p=slony1-engine.git;a=commitdiff;h=af01af7786f0f4f6c5c5ea991200be04a431f586

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.

From bugzilla-daemon at main.slony.info  Wed Oct  5 14:59:10 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Wed,  5 Oct 2011 14:59:10 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 243] New: Health Checks for foreign keys
Message-ID: <bug-243-4@http.www.slony.info/bugzilla/>

http://www.slony.info/bugzilla/show_bug.cgi?id=243

           Summary: Health Checks for foreign keys
           Product: Slony-I
           Version: devel
          Platform: All
        OS/Version: All
            Status: NEW
          Severity: enhancement
          Priority: low
         Component: core scripts
        AssignedTo: slony1-bugs at lists.slony.info
        ReportedBy: cbbrowne at ca.afilias.info
                CC: slony1-bugs at lists.slony.info
   Estimated Hours: 0.0


We should look for foreign key relationships that cross set boundaries from
various perspectives:

1. Foreign key on replicated table pointing to a non-replicated table
2. Foreign key on non-replicated table pointing to a replicated table
3. Foreign key on replicated table pointing to a table in a different
replication set with the same origin
4. Foreign key on replicated table pointing to a table in a different
replication set with a different origin

Other scenarios are uninteresting from a Slony perspective.

There are several ways that these issues might be reported, and we may wish to
consider using some or multiple of the following:

a) Initial health check run by slon upon startup, calling stored function
slon_node_health_check() 

b) The tool test_slony_state.pl

c) Perhaps a stand-alone tool to add to tools

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

From bugzilla-daemon at main.slony.info  Thu Oct  6 12:48:32 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Thu,  6 Oct 2011 12:48:32 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 237] drop set does not remove truncate triggers
In-Reply-To: <bug-237-4@http.www.slony.info/bugzilla/>
References: <bug-237-4@http.www.slony.info/bugzilla/>
Message-ID: <20111006194832.D4549290350@main.slony.info>

http://www.slony.info/bugzilla/show_bug.cgi?id=237

Christopher Browne <cbbrowne at ca.afilias.info> changed:

           What    |Removed                     |Added
----------------------------------------------------------------------------
         AssignedTo|cbbrowne at ca.afilias.info    |janwieck at yahoo.com

--- Comment #2 from Christopher Browne <cbbrowne at ca.afilias.info> 2011-10-06 12:48:32 PDT ---
I have revised the "legacy" regression tests to check this, with success:

https://github.com/cbbrowne/slony1-engine/commit/b06c96faaa06bd42d18f355759851700b07ec2f4

Here is a preliminary "clustertest" regression test; the parts that actually
run TRUNCATE need to be filled in.

https://github.com/cbbrowne/slony1-engine/commit/eb85c6dfa63832838d79db801f3f3749c597192b

Here is a revision to release notes for this change:

https://github.com/cbbrowne/slony1-engine/commit/b06c96faaa06bd42d18f355759851700b07ec2f4

I suggest taking my first and third patch as part of the release candidate.

I'll pursue getting the "clustertest" test set up with Steven; that shouldn't
hold up release.

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.

From bugzilla-daemon at main.slony.info  Thu Oct  6 13:51:18 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Thu,  6 Oct 2011 13:51:18 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 237] drop set does not remove truncate triggers
In-Reply-To: <bug-237-4@http.www.slony.info/bugzilla/>
References: <bug-237-4@http.www.slony.info/bugzilla/>
Message-ID: <20111006205118.94E59290CED@main.slony.info>

http://www.slony.info/bugzilla/show_bug.cgi?id=237

--- Comment #3 from Steve Singer <ssinger at ca.afilias.info> 2011-10-06 13:51:18 PDT ---

I have a question about this part of the patch (Jan's original patch).

-  perform @NAMESPACE at .add_truncate_triggers();
-
+  -- 2.0 was the only 2.x version without truncate support
+  if p_old like '2.0.%' then
+    perform @NAMESPACE at .upgradeSchemaAddTruncateTriggers();
+  end if;


With the 2.1 version prior to this patch if I upgrade an 8.3 server to a 8.4
server and run the slonik 'update functions' command everything works and
truncate triggers get added.  With this patch that won't happen anymore
correct?

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.

From bugzilla-daemon at main.slony.info  Thu Oct  6 15:21:22 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Thu,  6 Oct 2011 15:21:22 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 237] drop set does not remove truncate triggers
In-Reply-To: <bug-237-4@http.www.slony.info/bugzilla/>
References: <bug-237-4@http.www.slony.info/bugzilla/>
Message-ID: <20111006222122.DBAE8290D94@main.slony.info>

http://www.slony.info/bugzilla/show_bug.cgi?id=237

--- Comment #4 from Christopher Browne <cbbrowne at ca.afilias.info> 2011-10-06 15:21:23 PDT ---
A couple more commits to draw in...

1.  Spelling fix

https://github.com/cbbrowne/slony1-engine/commit/45f7547f0f9a1be57dd0127ff439205aa6ce07be

2.  Filling in the regression tests for truncation

https://github.com/cbbrowne/slony1-engine/commit/c68dcbdd5e9cbf4f482e27bf7e32849fdf16e6ed

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.

From bugzilla-daemon at main.slony.info  Fri Oct  7 07:11:14 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Fri,  7 Oct 2011 07:11:14 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 237] drop set does not remove truncate triggers
In-Reply-To: <bug-237-4@http.www.slony.info/bugzilla/>
References: <bug-237-4@http.www.slony.info/bugzilla/>
Message-ID: <20111007141114.1FADB290DED@main.slony.info>

http://www.slony.info/bugzilla/show_bug.cgi?id=237

--- Comment #5 from Jan Wieck <janwieck at yahoo.com> 2011-10-07 07:11:14 PDT ---
I removed the 2.0 check as per Steve's comment and merged in Chris' commits.

https://github.com/wieck/slony1-engine/commit/661c6e82167515a203bc8574c7e3f17d1c9f5cce

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.

From bugzilla-daemon at main.slony.info  Tue Oct 18 02:20:03 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Tue, 18 Oct 2011 02:20:03 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 244] New: create set is not well parsed
Message-ID: <bug-244-4@http.www.slony.info/bugzilla/>

http://www.slony.info/bugzilla/show_bug.cgi?id=244

           Summary: create set is not well parsed
           Product: Slony-I
           Version: devel
          Platform: PC
        OS/Version: Linux
            Status: NEW
          Severity: minor
          Priority: low
         Component: slonik
        AssignedTo: slony1-bugs at lists.slony.info
        ReportedBy: cedric.villemain.debian at gmail.com
                CC: slony1-bugs at lists.slony.info
   Estimated Hours: 0.0


you can use a "create set (origin = 1)" and it is not refuse by slonik but it
won't work:

 /usr/lib/postgresql/9.1/bin/slonik < create_set.slonik
<stdin>:4: PGRES_FATAL_ERROR select set_origin from "_slony"."sl_set" where
set_id=1 - ERREUR:  le sch?ma ? _slony ? n'existe pas
LINE 1: select set_origin from "_slony"."sl_set" where set_id=1
                               ^
<stdin>:4: PGRES_FATAL_ERROR select set_origin from "_slony"."sl_set" where
set_id=1 - ERREUR:  le sch?ma ? _slony ? n'existe pas
LINE 1: select set_origin from "_slony"."sl_set" where set_id=1
                               ^
<stdin>:4: PGRES_FATAL_ERROR select set_origin from "_slony"."sl_set" where
set_id=1 - ERREUR:  le sch?ma ? _slony ? n'existe pas
LINE 1: select set_origin from "_slony"."sl_set" where set_id=1
                               ^
<stdin>:4: warning: could not query node 2 for origin<stdin>:4: warning: could
not query node 3 for origin<stdin>:4: warning: could not query node 4 for
origin<stdin>:4:Error: unable to determine the origin for set 1

preamble.slonik:
    cluster name = slony;
    node 1 admin conninfo = 'dbname=slony_bench host=192.168.100.165
user=replicator';
    node 2 admin conninfo = 'dbname=slony_bench host=192.168.100.237
user=replicator';
    node 3 admin conninfo = 'dbname=slony_bench host=192.168.122.111
user=replicator';
    node 4 admin conninfo = 'dbname=slony_bench host=192.168.122.22
user=replicator';

create_set.slonik:
include </tmp/preamble.slonik>;
init cluster (id = 1);
create set (origin = 1);
set add table (set id=1, tables='public\\.*');

store node (id=2, event node=1);
store node (id=3, event node=1);
store node (id=4, event node=2);

store path (server = 1, client = 2, conninfo='dbname=slony_bench
host=192.168.100.165 user=replicator');
store path (server = 1, client = 3, conninfo='dbname=slony_bench
host=192.168.100.165 user=replicator');
store path (server = 1, client = 4, conninfo='dbname=slony_bench
host=192.168.100.165 user=replicator');

store path (server = 2, client = 1, conninfo='dbname=slony_bench
host=192.168.100.237 user=replicator');
store path (server = 2, client = 3, conninfo='dbname=slony_bench
host=192.168.100.237 user=replicator');
store path (server = 2, client = 4, conninfo='dbname=slony_bench
host=192.168.100.237 user=replicator');

store path (server = 3, client = 1, conninfo='dbname=slony_bench
host=192.168.122.111 user=replicator');
store path (server = 3, client = 2, conninfo='dbname=slony_bench
host=192.168.122.111 user=replicator');
store path (server = 3, client = 4, conninfo='dbname=slony_bench
host=192.168.122.111 user=replicator');

store path (server = 4, client = 1, conninfo='dbname=slony_bench
host=192.168.122.22 user=replicator');
store path (server = 4, client = 2, conninfo='dbname=slony_bench
host=192.168.122.22 user=replicator');
store path (server = 4, client = 3, conninfo='dbname=slony_bench
host=192.168.122.22 user=replicator');

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

From bugzilla-daemon at main.slony.info  Tue Oct 18 02:25:20 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Tue, 18 Oct 2011 02:25:20 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 245] New: slony tutorial + new feature (set add
 table with a regexp) does not work
Message-ID: <bug-245-4@http.www.slony.info/bugzilla/>

http://www.slony.info/bugzilla/show_bug.cgi?id=245

           Summary: slony tutorial + new feature (set add table with a
                    regexp) does not work
           Product: Slony-I
           Version: devel
          Platform: PC
        OS/Version: Linux
            Status: NEW
          Severity: major
          Priority: low
         Component: slonik
        AssignedTo: slony1-bugs at lists.slony.info
        ReportedBy: cedric.villemain.debian at gmail.com
                CC: slony1-bugs at lists.slony.info
   Estimated Hours: 0.0


based on the tutorial.

/usr/lib/postgresql/9.1/bin/slonik < create_set.slonik
<stdin>:8: waiting for event (1,5000000011) to be confirmed on node 2

same output for (very) long time, I have to kill slonik

preamble.slonik
    cluster name = slony;
    node 1 admin conninfo = 'dbname=slony_bench host=192.168.100.165
user=replicator';
    node 2 admin conninfo = 'dbname=slony_bench host=192.168.100.237
user=replicator';
    node 3 admin conninfo = 'dbname=slony_bench host=192.168.122.111
user=replicator';
    node 4 admin conninfo = 'dbname=slony_bench host=192.168.122.22
user=replicator';

create_set.slonik
include </tmp/preamble.slonik>;
init cluster (id = 1);
create set (id = 1, origin = 1);
set add table (set id=1, tables='public\\.*');

store node (id=2, event node=1);
store node (id=3, event node=1);
store node (id=4, event node=2);

store path (server = 1, client = 2, conninfo='dbname=slony_bench
host=192.168.100.165 user=replicator');
store path (server = 1, client = 3, conninfo='dbname=slony_bench
host=192.168.100.165 user=replicator');
store path (server = 1, client = 4, conninfo='dbname=slony_bench
host=192.168.100.165 user=replicator');

store path (server = 2, client = 1, conninfo='dbname=slony_bench
host=192.168.100.237 user=replicator');
store path (server = 2, client = 3, conninfo='dbname=slony_bench
host=192.168.100.237 user=replicator');
store path (server = 2, client = 4, conninfo='dbname=slony_bench
host=192.168.100.237 user=replicator');

store path (server = 3, client = 1, conninfo='dbname=slony_bench
host=192.168.122.111 user=replicator');
store path (server = 3, client = 2, conninfo='dbname=slony_bench
host=192.168.122.111 user=replicator');
store path (server = 3, client = 4, conninfo='dbname=slony_bench
host=192.168.122.111 user=replicator');

store path (server = 4, client = 1, conninfo='dbname=slony_bench
host=192.168.122.22 user=replicator');
store path (server = 4, client = 2, conninfo='dbname=slony_bench
host=192.168.122.22 user=replicator');
store path (server = 4, client = 3, conninfo='dbname=slony_bench
host=192.168.122.22 user=replicator');

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

From bugzilla-daemon at main.slony.info  Tue Oct 18 02:41:02 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Tue, 18 Oct 2011 02:41:02 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 245] slony tutorial + new feature (set add table
 with a regexp) does not work
In-Reply-To: <bug-245-4@http.www.slony.info/bugzilla/>
References: <bug-245-4@http.www.slony.info/bugzilla/>
Message-ID: <20111018094102.88A8C290E1F@main.slony.info>

http://www.slony.info/bugzilla/show_bug.cgi?id=245

--- Comment #1 from C?dric Villemain <cedric.villemain.debian at gmail.com> 2011-10-18 02:41:02 PDT ---
it happens that the problem come from the node 2 cascading to node 4.

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

From bugzilla-daemon at main.slony.info  Tue Oct 18 02:44:45 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Tue, 18 Oct 2011 02:44:45 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 245] slony tutorial + new feature (set add table
 with a regexp) does not work
In-Reply-To: <bug-245-4@http.www.slony.info/bugzilla/>
References: <bug-245-4@http.www.slony.info/bugzilla/>
Message-ID: <20111018094445.99B2D290E53@main.slony.info>

http://www.slony.info/bugzilla/show_bug.cgi?id=245

--- Comment #2 from C?dric Villemain <cedric.villemain.debian at gmail.com> 2011-10-18 02:44:45 PDT ---
I change the order of store node and it fix the situation. It is maybe expected
but slonik should prevent the deadlock here.

store node (id=2, event node=1);
store node (id=3, event node=1);
store path (server = 1, client = 2, conninfo='dbname=slony_bench
host=192.168.100.165 user=replicator');
store path (server = 1, client = 3, conninfo='dbname=slony_bench
host=192.168.100.165 user=replicator');
store path (server = 2, client = 1, conninfo='dbname=slony_bench
host=192.168.100.237 user=replicator');
store path (server = 2, client = 3, conninfo='dbname=slony_bench
host=192.168.100.237 user=replicator');
store path (server = 3, client = 1, conninfo='dbname=slony_bench
host=192.168.122.111 user=replicator');
store path (server = 3, client = 2, conninfo='dbname=slony_bench
host=192.168.122.111 user=replicator');

store node (id=4, event node=2);
store path (server = 1, client = 4, conninfo='dbname=slony_bench
host=192.168.100.165 user=replicator');
store path (server = 2, client = 4, conninfo='dbname=slony_bench
host=192.168.100.237 user=replicator');
store path (server = 3, client = 4, conninfo='dbname=slony_bench
host=192.168.122.111 user=replicator');
store path (server = 4, client = 1, conninfo='dbname=slony_bench
host=192.168.122.22 user=replicator');
store path (server = 4, client = 2, conninfo='dbname=slony_bench
host=192.168.122.22 user=replicator');
store path (server = 4, client = 3, conninfo='dbname=slony_bench
host=192.168.122.22 user=replicator');

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

From bugzilla-daemon at main.slony.info  Wed Oct 19 03:13:42 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Wed, 19 Oct 2011 03:13:42 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 245] slony tutorial + new feature (set add table
 with a regexp) does not work
In-Reply-To: <bug-245-4@http.www.slony.info/bugzilla/>
References: <bug-245-4@http.www.slony.info/bugzilla/>
Message-ID: <20111019101342.A37DC290E5A@main.slony.info>

http://www.slony.info/bugzilla/show_bug.cgi?id=245

--- Comment #3 from Steve Singer <ssinger at ca.afilias.info> 2011-10-19 03:13:42 PDT ---
This is an issue with the tutorial.

store node(id=2,event node=1)
store node(id=3,event node=1)
store node(id=4,event node=2);

should not work,  with until the third line has been propogated to node 2.

Consider these example as why

store node(id=2,event node=1)
store node(id=3,event node=1)
store node(id=3,event node=2);

The tutorial should be updated to either use event node=1
or it could be updated to put the store paths in between

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

From bugzilla-daemon at main.slony.info  Wed Oct 19 03:52:47 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Wed, 19 Oct 2011 03:52:47 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 245] slony tutorial + new feature (set add table
 with a regexp) does not work
In-Reply-To: <bug-245-4@http.www.slony.info/bugzilla/>
References: <bug-245-4@http.www.slony.info/bugzilla/>
Message-ID: <20111019105247.DE4EF290E41@main.slony.info>

http://www.slony.info/bugzilla/show_bug.cgi?id=245

--- Comment #4 from C?dric Villemain <cedric.villemain.debian at gmail.com> 2011-10-19 03:52:47 PDT ---
(In reply to comment #3)
> This is an issue with the tutorial.
> 
> store node(id=2,event node=1)
> store node(id=3,event node=1)
> store node(id=4,event node=2);
> 
> should not work,  with until the third line has been propogated to node 2.
> 
> Consider these example as why
> 
> store node(id=2,event node=1)
> store node(id=3,event node=1)
> store node(id=3,event node=2);
> 
> The tutorial should be updated to either use event node=1
> or it could be updated to put the store paths in between

I abused of the tutorial reference here, the tutorial is only for 2 nodes.
While I understand why it does not work,maybe slonik can check that there is no
'deadlock' in the slonik script.

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

From bugzilla-daemon at main.slony.info  Wed Oct 19 05:01:47 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Wed, 19 Oct 2011 05:01:47 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 245] slony tutorial + new feature (set add table
 with a regexp) does not work
In-Reply-To: <bug-245-4@http.www.slony.info/bugzilla/>
References: <bug-245-4@http.www.slony.info/bugzilla/>
Message-ID: <20111019120147.DE2A2290E41@main.slony.info>

http://www.slony.info/bugzilla/show_bug.cgi?id=245

--- Comment #5 from Steve Singer <ssinger at ca.afilias.info> 2011-10-19 05:01:47 PDT ---
Checking for deadlock due to missing paths sounds like a good idea. It was
discussed when the auto-wait for stuff was proposed but we didn't want to bite
off too much at once.

Patches always welcome :)

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

From bugzilla-daemon at main.slony.info  Wed Oct 26 13:54:53 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Wed, 26 Oct 2011 13:54:53 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 246] New: slony_funcs can be
Message-ID: <bug-246-4@http.www.slony.info/bugzilla/>

http://www.slony.info/bugzilla/show_bug.cgi?id=246

           Summary: slony_funcs can be
           Product: Slony-I
           Version: devel
          Platform: All
        OS/Version: Linux
            Status: NEW
          Severity: minor
          Priority: low
         Component: stored procedures
        AssignedTo: slony1-bugs at lists.slony.info
        ReportedBy: gmc at esilibrary.com
                CC: slony1-bugs at lists.slony.info
   Estimated Hours: 0.0


If the system that Slony is compiled on has libpq5 installed at a higher
version than Postgres itself, the slony1_funcs library can be stamped with the
the client library's version (taken from libpq's pg_config.h) rather than the
Pg server version.

This can result in failures like this:

<stdin>:9: PGRES_FATAL_ERROR load '$libdir/slony1_funcs';  - ERROR: 
incompatible library "/usr/lib/postgresql/9.0/lib/slony1_funcs.so": version
mismatch
DETAIL:  Server is version 9.0, library is version 9.1.

This was specifically encountered on a Debian squeeze/squeeze-backports system:

Package: libpq-dev                       
State: installed
Automatically installed: no
Version: 9.1.1-1~bpo60+1


Package: postgresql-server-dev-9.0
New: yes
State: installed
Automatically installed: no
Version: 9.0.5-1~bpo60+1

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

From bugzilla-daemon at main.slony.info  Wed Oct 26 13:55:24 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Wed, 26 Oct 2011 13:55:24 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 246] slony1_funcs.so can be stamped with wrong
 Postgres server version
In-Reply-To: <bug-246-4@http.www.slony.info/bugzilla/>
References: <bug-246-4@http.www.slony.info/bugzilla/>
Message-ID: <20111026205524.C6F50290E6A@main.slony.info>

http://www.slony.info/bugzilla/show_bug.cgi?id=246

Galen Charlton <gmc at esilibrary.com> changed:

           What    |Removed                     |Added
----------------------------------------------------------------------------
            Summary|slony_funcs can be          |slony1_funcs.so can be
                   |                            |stamped with wrong Postgres
                   |                            |server version

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

From bugzilla-daemon at main.slony.info  Wed Oct 26 14:02:40 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Wed, 26 Oct 2011 14:02:40 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 246] slony1_funcs.so can be stamped with wrong
 Postgres server version
In-Reply-To: <bug-246-4@http.www.slony.info/bugzilla/>
References: <bug-246-4@http.www.slony.info/bugzilla/>
Message-ID: <20111026210240.358E3290E3B@main.slony.info>

http://www.slony.info/bugzilla/show_bug.cgi?id=246

--- Comment #1 from Galen Charlton <gmc at esilibrary.com> 2011-10-26 14:02:40 PDT ---
Created an attachment (id=128)
 --> (http://www.slony.info/bugzilla/attachment.cgi?id=128)
proposed fix

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

From bugzilla-daemon at main.slony.info  Fri Oct 28 08:55:43 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Fri, 28 Oct 2011 08:55:43 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 246] slony1_funcs.so can be stamped with wrong
 Postgres server version
In-Reply-To: <bug-246-4@http.www.slony.info/bugzilla/>
References: <bug-246-4@http.www.slony.info/bugzilla/>
Message-ID: <20111028155543.C337D290E39@main.slony.info>

http://www.slony.info/bugzilla/show_bug.cgi?id=246

Steve Singer <ssinger at ca.afilias.info> changed:

           What    |Removed                     |Added
----------------------------------------------------------------------------
         Resolution|                            |FIXED
             Status|NEW                         |RESOLVED

--- Comment #2 from Steve Singer <ssinger at ca.afilias.info> 2011-10-28 08:55:43 PDT ---
Thanks for the report and the patch.

I have committed this patch to REL_2_1_STABLE and master.
slon and slonik now get serverinclude path before libpq even though they really
only use libpq. I hope this doesn't cause issues for installations trying to
link with a newer libpq than the server version.

I thought about only including serverinclude in the makefile in src/backend
(which doesn't actually need libpq)  That would be better, except we have a
patch floating around to make slonik again call find_my_exec from pgport.  If
slonik is using pgport then it needs the server include headers anyway.  

Since I don't want to have to revist this if/when a version of the find_my_exec
patch is resubmitted  I committed the patch as is.

http://git.postgresql.org/gitweb/?p=slony1-engine.git;a=commit;h=6cdedf5c1c0600b882ff891c8128c95c5e082fd2
http://git.postgresql.org/gitweb/?p=slony1-engine.git;a=commit;h=d18618f43f48e553cdea24b6949730d22e4585e8

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

