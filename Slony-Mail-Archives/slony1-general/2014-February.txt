From david at fetter.org  Fri Feb  7 16:35:56 2014
From: david at fetter.org (David Fetter)
Date: Fri, 7 Feb 2014 16:35:56 -0800
Subject: [Slony1-general] Adding triggers to tables in a replication set
Message-ID: <20140208003556.GA23458@fetter.org>

Folks,

I'm about to embark on a new thing: auditing.  In order to get this
auditing actually done, I'll be using an extension I've written
https://github.com/disqus/pg_audit

The extension generates some triggers on tables in an extant
replication set, which triggers should fire on the origin.  What
I'd like to figure out is how to add the auditing stuff on replicas,
as the triggers should not fire there, or at least not until same gets
promoted to origin.

Any tips as to how generally to add triggers across an existing
replication set?

Cheers,
David.
-- 
David Fetter <david at fetter.org> http://fetter.org/
Phone: +1 415 235 3778  AIM: dfetter666  Yahoo!: dfetter
Skype: davidfetter      XMPP: david.fetter at gmail.com
iCal: webcal://www.tripit.com/feed/ical/people/david74/tripit.ics

Remember to vote!
Consider donating to Postgres: http://www.postgresql.org/about/donate

From steve at ssinger.info  Sat Feb  8 09:23:55 2014
From: steve at ssinger.info (Steve Singer)
Date: Sat, 8 Feb 2014 12:23:55 -0500
Subject: [Slony1-general] Adding triggers to tables in a replication set
In-Reply-To: <20140208003556.GA23458@fetter.org>
References: <20140208003556.GA23458@fetter.org>
Message-ID: <BLU0-SMTP54E045C3AE7C430D19414EDC960@phx.gbl>

On Fri, 7 Feb 2014, David Fetter wrote:

> Folks,
>
> I'm about to embark on a new thing: auditing.  In order to get this
> auditing actually done, I'll be using an extension I've written
> https://github.com/disqus/pg_audit
>
> The extension generates some triggers on tables in an extant
> replication set, which triggers should fire on the origin.  What
> I'd like to figure out is how to add the auditing stuff on replicas,
> as the triggers should not fire there, or at least not until same gets
> promoted to origin.
>
> Any tips as to how generally to add triggers across an existing
> replication set?
>

Just add the triggers to your tables as you normally would on all nodes. By 
default the triggers will fire on the origin but not fire on the replica when 
session_replication_role is replica (which it is when slon pushes stuff).

http://www.slony.info/documentation/2.2/triggers.html




> Cheers,
> David.
> -- 
> David Fetter <david at fetter.org> http://fetter.org/
> Phone: +1 415 235 3778  AIM: dfetter666  Yahoo!: dfetter
> Skype: davidfetter      XMPP: david.fetter at gmail.com
> iCal: webcal://www.tripit.com/feed/ical/people/david74/tripit.ics
>
> Remember to vote!
> Consider donating to Postgres: http://www.postgresql.org/about/donate
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general
>


