From david at fetter.org  Fri Feb  7 16:35:56 2014
From: david at fetter.org (David Fetter)
Date: Fri, 7 Feb 2014 16:35:56 -0800
Subject: [Slony1-general] Adding triggers to tables in a replication set
Message-ID: <20140208003556.GA23458@fetter.org>

Folks,

I'm about to embark on a new thing: auditing.  In order to get this
auditing actually done, I'll be using an extension I've written
https://github.com/disqus/pg_audit

The extension generates some triggers on tables in an extant
replication set, which triggers should fire on the origin.  What
I'd like to figure out is how to add the auditing stuff on replicas,
as the triggers should not fire there, or at least not until same gets
promoted to origin.

Any tips as to how generally to add triggers across an existing
replication set?

Cheers,
David.
-- 
David Fetter <david at fetter.org> http://fetter.org/
Phone: +1 415 235 3778  AIM: dfetter666  Yahoo!: dfetter
Skype: davidfetter      XMPP: david.fetter at gmail.com
iCal: webcal://www.tripit.com/feed/ical/people/david74/tripit.ics

Remember to vote!
Consider donating to Postgres: http://www.postgresql.org/about/donate

From steve at ssinger.info  Sat Feb  8 09:23:55 2014
From: steve at ssinger.info (Steve Singer)
Date: Sat, 8 Feb 2014 12:23:55 -0500
Subject: [Slony1-general] Adding triggers to tables in a replication set
In-Reply-To: <20140208003556.GA23458@fetter.org>
References: <20140208003556.GA23458@fetter.org>
Message-ID: <BLU0-SMTP54E045C3AE7C430D19414EDC960@phx.gbl>

On Fri, 7 Feb 2014, David Fetter wrote:

> Folks,
>
> I'm about to embark on a new thing: auditing.  In order to get this
> auditing actually done, I'll be using an extension I've written
> https://github.com/disqus/pg_audit
>
> The extension generates some triggers on tables in an extant
> replication set, which triggers should fire on the origin.  What
> I'd like to figure out is how to add the auditing stuff on replicas,
> as the triggers should not fire there, or at least not until same gets
> promoted to origin.
>
> Any tips as to how generally to add triggers across an existing
> replication set?
>

Just add the triggers to your tables as you normally would on all nodes. By 
default the triggers will fire on the origin but not fire on the replica when 
session_replication_role is replica (which it is when slon pushes stuff).

http://www.slony.info/documentation/2.2/triggers.html




> Cheers,
> David.
> -- 
> David Fetter <david at fetter.org> http://fetter.org/
> Phone: +1 415 235 3778  AIM: dfetter666  Yahoo!: dfetter
> Skype: davidfetter      XMPP: david.fetter at gmail.com
> iCal: webcal://www.tripit.com/feed/ical/people/david74/tripit.ics
>
> Remember to vote!
> Consider donating to Postgres: http://www.postgresql.org/about/donate
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general
>


From vivek at khera.org  Tue Feb 11 17:46:26 2014
From: vivek at khera.org (Vick Khera)
Date: Tue, 11 Feb 2014 20:46:26 -0500
Subject: [Slony1-general] Adding triggers to tables in a replication set
In-Reply-To: <BLU0-SMTP54E045C3AE7C430D19414EDC960@phx.gbl>
References: <20140208003556.GA23458@fetter.org>
	<BLU0-SMTP54E045C3AE7C430D19414EDC960@phx.gbl>
Message-ID: <CALd+dce1Pci+-WF+6HygD1Gwti3-rbNYxOyDBmRn1DUD5PfZfQ@mail.gmail.com>

On Sat, Feb 8, 2014 at 12:23 PM, Steve Singer <steve at ssinger.info> wrote:

> Just add the triggers to your tables as you normally would on all nodes.


Which is to say using slonik to run the SQL script that will add them.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20140211/751d6a9d/attachment.htm 

From david at fetter.org  Tue Feb 11 19:27:06 2014
From: david at fetter.org (David Fetter)
Date: Tue, 11 Feb 2014 19:27:06 -0800
Subject: [Slony1-general] Adding triggers to tables in a replication set
In-Reply-To: <CALd+dce1Pci+-WF+6HygD1Gwti3-rbNYxOyDBmRn1DUD5PfZfQ@mail.gmail.com>
References: <20140208003556.GA23458@fetter.org>
	<BLU0-SMTP54E045C3AE7C430D19414EDC960@phx.gbl>
	<CALd+dce1Pci+-WF+6HygD1Gwti3-rbNYxOyDBmRn1DUD5PfZfQ@mail.gmail.com>
Message-ID: <20140212032706.GA18036@fetter.org>

On Tue, Feb 11, 2014 at 08:46:26PM -0500, Vick Khera wrote:
> On Sat, Feb 8, 2014 at 12:23 PM, Steve Singer <steve at ssinger.info> wrote:
> 
> > Just add the triggers to your tables as you normally would on all nodes.
> 
> Which is to say using slonik to run the SQL script that will add them.

Thanks for clarifying that.  It's kinda important :)

Cheers,
David.
-- 
David Fetter <david at fetter.org> http://fetter.org/
Phone: +1 415 235 3778  AIM: dfetter666  Yahoo!: dfetter
Skype: davidfetter      XMPP: david.fetter at gmail.com
iCal: webcal://www.tripit.com/feed/ical/people/david74/tripit.ics

Remember to vote!
Consider donating to Postgres: http://www.postgresql.org/about/donate

From ssinger at ca.afilias.info  Tue Feb 11 19:37:52 2014
From: ssinger at ca.afilias.info (Steve Singer)
Date: Tue, 11 Feb 2014 22:37:52 -0500
Subject: [Slony1-general] Slony 2.2.2  released
Message-ID: <52FAEC90.4000109@ca.afilias.info>

The slony team is pleased to announce a bug-fix release for the 2.2
version of the slony replication system.  Slony 2.2.2
addresses a number
of bugs including:


     Bug 327 - Fix invalid free() in the logApply trigger

     Include server include paths on --with-pgport builds for slonik

Bug 327 can cause replication to not work properly for some users of 
slony 2.2.0 and 2.2.1.

Users of Slony 2.2.0  or 2.2.1 are encouraged to upgrade.  Users who are 
upgrading
from versions earlier than 2.2.0 should upgrade to version 2.2.2 instead
of 2.2.0

You can download Slony 2.2.2 at the following
http://lists.slony.info/downloads/2.2/source/slony1-2.2.2.tar.bz2

