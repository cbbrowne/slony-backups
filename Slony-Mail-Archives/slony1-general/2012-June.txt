From faber_pad at yahoo.it  Fri Jun  1 11:39:56 2012
From: faber_pad at yahoo.it (Fabio P.)
Date: Fri, 1 Jun 2012 19:39:56 +0100 (BST)
Subject: [Slony1-general] Question on failover on slony 1.23
Message-ID: <1338575996.81198.YahooMailNeo@web29704.mail.ird.yahoo.com>



?
Dear all,

I used the slony v1.23 to create a cluster on a postgres db v8.0.x, I am using this old version of slony since, due to constraints on software using the db I cannot upgrade the postgres version.
The database to be put in safety using slony is composed of 4 databases.
The main goal I need to reach is to have a master and a slave containing the same data and, in case of failure on the main host to switch on the slave and use them in read/write mode.
Following the instruction in slony documentation I was able to create the first part (i.e. the data mirroring on the slave), the second part is very far to be reached since the slave is locked. Is there any way to unlock the slave? It could be also accettable for me to destroy all the cluster information ?on the slave and to use them as the slony was never used and in case of newly availability of the master to dump/import the databases newly on the master and to recreate again the whole cluster, but I was not able to do this since it seems that there are a lot of "zombies" objects not identifieble in simply way, is there any chanche to use a sort of bigbang tool on the slave cleaning up all slony structures (but leaving the business data unchanged)?
I guess there is the possibility that this email address is not that I have to use, if this is the case, I would ask if there is any address(or forum) I can use.
Many thanks in advance.
Fabio.?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20120601/2baa9e3d/attachment.htm 

From laurapassigni at yahoo.it  Mon Jun  4 02:07:04 2012
From: laurapassigni at yahoo.it (Laura Passigni)
Date: Mon, 4 Jun 2012 10:07:04 +0100 (BST)
Subject: [Slony1-general] FOR UPDATE query
Message-ID: <1338800824.92959.YahooMailNeo@web28706.mail.ir2.yahoo.com>

Hi, 
I found in my server the following query, waiting for more than 1 day.
?
SELECT * FROM "my_table" WHERE ("my_table"."id" = 2626968981)? FOR UPDATE;
?
It is not?coming form my client, in fact it is from the internal server.
My_table is a table involved in the slony, so I was wondering if this query is launched by slony process.
Can someone help me in understanding this? 
?
Thank you,
Laura Passigni
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20120604/cf66c4e0/attachment.htm 

From ssinger at ca.afilias.info  Mon Jun  4 06:58:38 2012
From: ssinger at ca.afilias.info (Steve Singer)
Date: Mon, 04 Jun 2012 09:58:38 -0400
Subject: [Slony1-general] Question on failover on slony 1.23
In-Reply-To: <1338575996.81198.YahooMailNeo@web29704.mail.ird.yahoo.com>
References: <1338575996.81198.YahooMailNeo@web29704.mail.ird.yahoo.com>
Message-ID: <4FCCBF0E.9080503@ca.afilias.info>

On 12-06-01 02:39 PM, Fabio P. wrote:
>
> Dear all,
>
> I used the slony v1.23 to create a cluster on a postgres db v8.0.x, I am
> using this old version of slony since, due to constraints on software
> using the db I cannot upgrade the postgres version.
> The database to be put in safety using slony is composed of 4 databases.
> The main goal I need to reach is to have a master and a slave containing
> the same data and, in case of failure on the main host to switch on the
> slave and use them in read/write mode.
> Following the instruction in slony documentation I was able to create
> the first part (i.e. the data mirroring on the slave), the second part
> is very far to be reached since the slave is locked. Is there any way to
> unlock the slave? It could be also accettable for me to destroy all the
> cluster information on the slave and to use them as the slony was never

1) The FAILOVER command will unlock the tables on the slave. See 
http://www.slony.info/documentation/1.2/stmtfailover.html

2) Use the UNINSTALL NODE 
http://www.slony.info/documentation/1.2/stmtuninstallnode.html command 
to uninstall slony on the slave

The UNINSTALL NODE command will remove all the slony information on the 
slave.


> used and in case of newly availability of the master to dump/import the
> databases newly on the master and to recreate again the whole cluster,
> but I was not able to do this since it seems that there are a lot of
> "zombies" objects not identifieble in simply way, is there any chanche
> to use a sort of bigbang tool on the slave cleaning up all slony
> structures (but leaving the business data unchanged)?
> I guess there is the possibility that this email address is not that I
> have to use, if this is the case, I would ask if there is any address(or
> forum) I can use.
> Many thanks in advance.
> Fabio.
>
>
>
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general


From cbbrowne at afilias.info  Mon Jun  4 07:58:04 2012
From: cbbrowne at afilias.info (Christopher Browne)
Date: Mon, 4 Jun 2012 10:58:04 -0400
Subject: [Slony1-general] FOR UPDATE query
In-Reply-To: <1338800824.92959.YahooMailNeo@web28706.mail.ir2.yahoo.com>
References: <1338800824.92959.YahooMailNeo@web28706.mail.ir2.yahoo.com>
Message-ID: <CANfbgbbvKKOysOvgSmFiHuJFqzdrrf1YtgdY+scyz1a6hyHKWA@mail.gmail.com>

On Mon, Jun 4, 2012 at 5:07 AM, Laura Passigni <laurapassigni at yahoo.it> wrote:
>
> Hi,
> I found in my server the following query, waiting for more than 1 day.
>
> SELECT * FROM "my_table" WHERE ("my_table"."id" = 2626968981)? FOR UPDATE;
>
> It is not?coming form my client, in fact it is from the internal server.
> My_table is a table involved in the slony, so I was wondering if this query is launched by slony process.
> Can someone help me in understanding this?

That doesn't seem like a query that Slony would generate.

If you have set up Slony to use its own user, then you could check
pg_stat_activity, and validate that that query isn't being run as that
user.

From riyav at hotmail.com  Tue Jun  5 11:27:21 2012
From: riyav at hotmail.com (Riya V)
Date: Tue, 5 Jun 2012 11:27:21 -0700
Subject: [Slony1-general] creating a new trigger for a table on a slave host
Message-ID: <BLU166-W3030AE8EF3E51FD36A32CABA0C0@phx.gbl>










I need to modify my database schema and create a new trigger function. I know that triggers are suppressed on the slave once Slony starts up. However since slony is now already running on the slave, if I create a new trigger there, it will not be suppressed. What is the best practice for creating a trigger on the slave? Should you take the table out of replication, create trigger , then add the table back in? Is there some other way to do it? 
Thanks!
RV 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20120605/0e9a10d7/attachment.htm 

From ssinger at ca.afilias.info  Tue Jun  5 14:33:50 2012
From: ssinger at ca.afilias.info (Steve Singer)
Date: Tue, 05 Jun 2012 17:33:50 -0400
Subject: [Slony1-general] slony.info website outage
Message-ID: <4FCE7B3E.308@ca.afilias.info>

The slony.info website will be taken offline for maintenance on:

Tuesday June 5 starting around 7pm PST.

* The website - www.slony.info
* The slony bugzilla instance
* All slony mailing lists

will be offline, this is expected to last a few hours.



Thanks

From glynastill at yahoo.co.uk  Wed Jun  6 04:19:02 2012
From: glynastill at yahoo.co.uk (Glyn Astill)
Date: Wed, 6 Jun 2012 12:19:02 +0100 (BST)
Subject: [Slony1-general] creating a new trigger for a table on a slave
	host
In-Reply-To: <BLU166-W3030AE8EF3E51FD36A32CABA0C0@phx.gbl>
References: <BLU166-W3030AE8EF3E51FD36A32CABA0C0@phx.gbl>
Message-ID: <1338981542.99081.YahooMailNeo@web171402.mail.ir2.yahoo.com>

What version of slony?? 


For 1.2 and earlier add the trigger via slonik and use store trigger if you want to enable it:

http://slony.info/documentation/1.2/stmtstoretrigger.html

For 2.0 and later use DISABLE/ENABLE [REPLICA|ALWAYS] TRIGGER in postgresql.




>________________________________
> From: Riya V <riyav at hotmail.com>
>To: slony1-general at lists.slony.info 
>Sent: Tuesday, 5 June 2012, 19:27
>Subject: [Slony1-general] creating a new trigger for a table on a slave host
> 
>
> 
>I need to modify my database schema and create a new trigger function. I know that triggers are suppressed on the slave once Slony starts up. However since slony is now already running on the slave, if I create a new trigger there, it will not be suppressed. What is the best practice for creating a trigger on the slave? Should you take the table out of replication, create trigger , then add the table back in? Is there some other way to do it??
>Thanks!
>
>
>RV
>_______________________________________________
>Slony1-general mailing list
>Slony1-general at lists.slony.info
>http://lists.slony.info/mailman/listinfo/slony1-general
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20120606/15772264/attachment.html 

From glynastill at yahoo.co.uk  Wed Jun  6 14:53:13 2012
From: glynastill at yahoo.co.uk (Glyn Astill)
Date: Wed, 6 Jun 2012 22:53:13 +0100 (BST)
Subject: [Slony1-general] creating a new trigger for a table on a slave
	host
In-Reply-To: <BLU166-W6317BDD84E504C4730972CBA0D0@phx.gbl>
References: <BLU166-W3030AE8EF3E51FD36A32CABA0C0@phx.gbl>,
	<1338981542.99081.YahooMailNeo@web171402.mail.ir2.yahoo.com>
	<BLU166-W6317BDD84E504C4730972CBA0D0@phx.gbl>
Message-ID: <1339019593.43501.YahooMailNeo@web171402.mail.ir2.yahoo.com>

Great, try to keep the messages on the mailing list.




>________________________________
> From: Riya V <riyav at hotmail.com>
>To: glynastill at yahoo.co.uk 
>Sent: Wednesday, 6 June 2012, 18:12
>Subject: RE: [Slony1-general] creating a new trigger for a table on a slave host
> 
>
> 
>Thanks!
>We are on 1.2 now and planning to move to 2.X
>
>
>Riya
>
>
>
>________________________________
>Date: Wed, 6 Jun 2012 12:19:02 +0100
>From: glynastill at yahoo.co.uk
>Subject: Re: [Slony1-general] creating a new trigger for a table on a slave host
>To: riyav at hotmail.com; slony1-general at lists.slony.info
>
>
>What version of slony?? 
>
>
>
>For 1.2 and earlier add the trigger via slonik and use store trigger if you want to enable it:
>
>
>http://slony.info/documentation/1.2/stmtstoretrigger.html
>
>
>For 2.0 and later use DISABLE/ENABLE [REPLICA|ALWAYS] TRIGGER in postgresql.
>
>
>
>>________________________________
>> From: Riya V <riyav at hotmail.com>
>>To: slony1-general at lists.slony.info 
>>Sent: Tuesday, 5 June 2012, 19:27
>>Subject: [Slony1-general] creating a new trigger for a table on a slave host
>> 
>>
>> 
>>I need to modify my database schema and create a new trigger function. I know that triggers are suppressed on the slave once Slony starts up. However since slony is now already running on the slave, if I create a new trigger there, it will not be suppressed. What is the best practice for creating a trigger on the slave? Should you take the table out of replication, create trigger , then add the table back in? Is there some other way to do it??
>>Thanks!
>>
>>
>>RV
>>_______________________________________________
>>Slony1-general mailing list
>>Slony1-general at lists.slony.info
>>http://lists.slony.info/mailman/listinfo/slony1-general
>>
>>
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20120606/0c163a2a/attachment.htm 

