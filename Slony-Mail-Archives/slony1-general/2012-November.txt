From luiz.matsumura at gmail.com  Tue Nov  6 17:02:05 2012
From: luiz.matsumura at gmail.com (Luiz Matsumura)
Date: Tue, 6 Nov 2012 23:02:05 -0200
Subject: [Slony1-general] Altperl tools changes
In-Reply-To: <CANfbgbb6dnsqe0cO+2DhWGho2boU1WkmaMCOQf4__CSJJbepAA@mail.gmail.com>
References: <CAC6zyU7YsbgKL+8C5EAxUzsvwYpZ6hEX7EOhLr_07oat8mPMRw@mail.gmail.com>
	<CANfbgbb6dnsqe0cO+2DhWGho2boU1WkmaMCOQf4__CSJJbepAA@mail.gmail.com>
Message-ID: <CAC6zyU7sFvCjF3c=o8cQ1-wL3JC0ERVBbKvRviSAvBvuMsLZNA@mail.gmail.com>

2012/10/29 Christopher Browne <cbbrowne at afilias.info>:
>
> I should probably take a peek at this later in the week; a good place
> to go next would be to review your changes in place, and add comments
> to the patches if there's anything that seems controversial.  From
> what you're describing, the changes sound generally reasonable.

Hi Christopher !
I made changes on the controversial parts based on solutions suggested
by Steve Singer.

I don?t know if github warns about the changes to you, so sorry by the
noise if they do.

Can you review again if the changes are satisfactory ?

Thanks in advance.

https://github.com/lkmatsumura/slony1-engine/commits/altperl
https://github.com/lkmatsumura/slony1-engine/commits/master

From glynastill at yahoo.co.uk  Thu Nov  8 09:31:45 2012
From: glynastill at yahoo.co.uk (Glyn Astill)
Date: Thu, 8 Nov 2012 17:31:45 +0000 (GMT)
Subject: [Slony1-general] Lock set behaviour difference between 2.0 and 2.1
Message-ID: <1352395905.8369.YahooMailNeo@web133204.mail.ir2.yahoo.com>

Hi Guys,

I was just taking a look at the changes to lockset() between 2.0 and 2.1 and noticed it now uses a lock on the row in sl_set rather than a table lock on sl_config_lock.

I was wondering, does this now make it possible to do something along the lines of:

TRY {
LOCK SET ( ID = 1, ORIGIN = 1);
LOCK SET ( ID = 2, ORIGIN = 1);
}
ON ERROR ( blah }
MOVE SET ( ID = 1, OLD ORIGIN = 1, NEW ORIGIN = 2);
WAIT FOR EVENT (ORIGIN = 1, CONFIRMED = ALL, WAIT ON = 1, TIMEOUT = 0);
MOVE SET ( ID = 2, OLD ORIGIN = 1, NEW ORIGIN = 2);
WAIT FOR EVENT (ORIGIN = 1, CONFIRMED = ALL, WAIT ON = 1, TIMEOUT = 0);

(Or even wrap the move sets in a try too?)

The reason I ask is we're currently using 2.0.7 and when we move a bunch of sets between nodes it'd be ideal if they were all locked before they were moved.

Sorry if I've got the wrong end of the stick here, or this has already been answered somewhere, I did do a good search before posting!

Thanks
Glyn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20121108/5b888eff/attachment.htm 

