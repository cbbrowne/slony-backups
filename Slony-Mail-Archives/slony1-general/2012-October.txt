From vivek at khera.org  Mon Oct  1 07:26:32 2012
From: vivek at khera.org (Vick Khera)
Date: Mon, 1 Oct 2012 10:26:32 -0400
Subject: [Slony1-general] Slony replication between two database (server
 and workshop) sometimes not fired
In-Reply-To: <34482368.post@talk.nabble.com>
References: <34482368.post@talk.nabble.com>
Message-ID: <CALd+dcfWvzj6riNjEXiMaoEY0LsznJa0EE6MPDonFUrQwNXHWA@mail.gmail.com>

Slony disables triggers on replicated tables on all but the origin server.
 Thus, table A on your workshop will not fire any triggers when it is
updated. Also, it should be denying you to alter any rows in the table A on
workshop.  How are you doing that?

On Wed, Sep 26, 2012 at 9:53 AM, nicogineau <nicolas.gineau at productys.com>wrote:

> - Fire of a trigger on modification, which updates a field of the B table
> on
> the Workshop --> OK,
> - Here is my problem: the modification of the field of the B table on the
> Workshop is not replicated on the Server.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20121001/faadacf0/attachment.html 

From ssinger at ca.afilias.info  Mon Oct  1 10:42:28 2012
From: ssinger at ca.afilias.info (Steve Singer)
Date: Mon, 01 Oct 2012 13:42:28 -0400
Subject: [Slony1-general] Issue when adding node to replication
In-Reply-To: <5065EF02.2010007@consistentstate.com>
References: <50649C28.2010002@consistentstate.com> <5064A859.9030606@Yahoo.com>
	<5064A8F0.9080801@consistentstate.com>
	<5064AFC8.6080105@consistentstate.com>
	<5064C487.6040709@Yahoo.com> <5065A2EA.3030606@ca.afilias.info>
	<5065C0DF.60609@Yahoo.com> <5065C270.9090109@ca.afilias.info>
	<5065EF02.2010007@consistentstate.com>
Message-ID: <5069D604.5090100@ca.afilias.info>

On 12-09-28 02:40 PM, Brian Fehrle wrote:

> Is there anything I can provide that could help us dig into this more?
> Are we counting this as a bug that may have been fixed in 2.2(haven't
> looked at what you mentioned yet Steve)?

My best guess is that this like the situation that Jan described where 
one thread was processing/adding a SYNC from the dropped node at the 
same time a different thread in the same slon was processing the DROP 
NODE.

My understanding is that the automatic WAIT FOR in 2.1 only waits for 
non-sync events to propogate everywhere before starting with the DROP 
NODE.  I *think* this has been fixed in 2.2 but 2.2 does need more testing.



>
> Thanks,
> - Brian F
>
>>
>>>
>>> Jan
>>>
>>
>


From JanWieck at Yahoo.com  Mon Oct  1 12:36:30 2012
From: JanWieck at Yahoo.com (Jan Wieck)
Date: Mon, 01 Oct 2012 15:36:30 -0400
Subject: [Slony1-general] Issue when adding node to replication
In-Reply-To: <5065EF02.2010007@consistentstate.com>
References: <50649C28.2010002@consistentstate.com> <5064A859.9030606@Yahoo.com>
	<5064A8F0.9080801@consistentstate.com>
	<5064AFC8.6080105@consistentstate.com>
	<5064C487.6040709@Yahoo.com> <5065A2EA.3030606@ca.afilias.info>
	<5065C0DF.60609@Yahoo.com> <5065C270.9090109@ca.afilias.info>
	<5065EF02.2010007@consistentstate.com>
Message-ID: <5069F0BE.4060807@Yahoo.com>

On 9/28/2012 2:40 PM, Brian Fehrle wrote:
> I'm going to go ahead and delete the offending row in sl_event for the
> node that doesn't exist. This is a production environment so I need to
> get up and running again.

Deleting a SYNC event of a non-origin node can never have any negative 
side effects. They are noise that keeps sl_status looking good, but 
that's really all they do.

SYNC events from a set origin are a little different. A SYNC immediately 
before an EXECUTE_SCRIPT event prior to 2.2 may be important. Other than 
that, they don't matter that much either.

When a node has fallen behind, it deliberately skips a number of SYNC 
events, a feature we call sync-grouping, to catch up in larger leaps. 
There is no difference at all between slon grouping SYNC events and some 
SYNC event rows missing in sl_event. Absolutely zero difference.

The difference for the SYNC event from a set origin in front of an 
EXECUTE_SCRIPT is because that DDL may add a column to a table. That 
SYNC event was supposed to make sure that the column exists on a 
subscriber when the first data containing that column appeared in 
sl_log_N. That all changed in 2.2 as well, where DDL from script 
execution now travels within sl_log_N too, so as of 2.2 you can simply 
delete all SYNC events from sl_event if you feel like. Slon will 
generate another SYNC soon and the processing of that will just leap the 
receivers to that state.


Jan

-- 
Anyone who trades liberty for security deserves neither
liberty nor security. -- Benjamin Franklin

From david at mudah.my  Wed Oct  3 01:58:02 2012
From: david at mudah.my (David Chin)
Date: Wed, 3 Oct 2012 08:58:02 +0000 (UTC)
Subject: [Slony1-general]
	=?utf-8?q?problem_with_slonik=5Fmove=5Fset_only_?=
	=?utf-8?q?changing_the_subscription_on_one_node?=
References: <4845263F.5030401@albourne.com>
Message-ID: <loom.20121003T105626-572@post.gmane.org>

Hi Martin,

It seems like we share the sentiment. It seems like it has become a cascaded
replication.

Did you manage to resolve this? Can share?

-David


From nyamada at millburncorp.com  Thu Oct  4 11:47:12 2012
From: nyamada at millburncorp.com (Norman Yamada)
Date: Thu, 4 Oct 2012 14:47:12 -0400
Subject: [Slony1-general] pg_reorg and reorganizing tables in slony cluster
Message-ID: <434FA33C-7A0B-4B85-92D6-44533C19B163@millburncorp.com>

Dear all -- I've discovered a problem using pg_reorg 1.1.7 with Slony versions 2.0 and/or 2.1. 

If you run a reorg on a table that is part of a slony slave set while there is write activity on the master node, pg_reorg will silently drop changes committed by slony to the slave node during the reorganization.

The problem is that the z_reorg_trigger doesn't fire on the changes that slony commits to the slave table, because slony has a session_replication_role on the slave of REPLICA. 

To get around this, after the z_reorg_trigger is created on a table, you have to run the command

ALTER TABLE [table_name] ENABLE ALWAYS TRIGGER z_reorg_trigger. Then the log table will capture changes pushed by Slony (or other trigger-based replication programs) during the time of reorganizing the table.

This is a subtle problem, because pg_reorg works fine with reorganizing tables on the _master_ node of a slony set, but it will drop changes on the slave nodes silently.

If I have time, I'll try to write at least a rough patch for pg_reorg to fix this, but I'm hoping that both the pg_reorg and slony community can be aware of this problem. Until it's fixed, best practice would be to stop slony while reorganizing tables on a slave node.

Best,

Norman Yamada

(Cross-posted to reorg_general at pgfoundry.org)

From mjames at profitpoint.com  Thu Oct  4 11:52:28 2012
From: mjames at profitpoint.com (Mike James)
Date: Thu, 4 Oct 2012 18:52:28 +0000
Subject: [Slony1-general] offline log shipping errors
Message-ID: <F024DCE3402750409CD407C414C07E1A8C3D6E@BY2PRD0811MB404.namprd08.prod.outlook.com>

Hi, our DBA stopped log shipping to create a new replication set. When he resumed log shipping, the next sequence number on the offline node is not consistent with the new log sequence numbers coming from the cluster. This is my 1st experience using Postgres/Slony and I don't know how to resolve this. I have not found a straightforward resolution of this in Google searches - probably I'm using the wrong keywords.

Please point me in the right direction. Thanks, Mike
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20121004/7bbe681b/attachment.htm 

From ssinger at ca.afilias.info  Thu Oct  4 12:02:09 2012
From: ssinger at ca.afilias.info (Steve Singer)
Date: Thu, 04 Oct 2012 15:02:09 -0400
Subject: [Slony1-general] offline log shipping errors
In-Reply-To: <F024DCE3402750409CD407C414C07E1A8C3D6E@BY2PRD0811MB404.namprd08.prod.outlook.com>
References: <F024DCE3402750409CD407C414C07E1A8C3D6E@BY2PRD0811MB404.namprd08.prod.outlook.com>
Message-ID: <506DDD31.20507@ca.afilias.info>

On 12-10-04 02:52 PM, Mike James wrote:
> Hi, our DBA stopped log shipping to create a new replication set. When
> he resumed log shipping, the next sequence number on the offline node is
> not consistent with the new log sequence numbers coming from the
> cluster. This is my 1^st experience using Postgres/Slony and I don?t
> know how to resolve this. I have not found a straightforward resolution
> of this in Google searches ? probably I?m using the wrong keywords.
>

What exactly do you mean by 'stopped log shipping' ?

Do you mean that he shutdown the slon then restarted it without the -a 
option?

If so I think you will need to rebuild the offline node from scratch 
with slony1_dump.sh because there is no longer a record of the changes 
that the slon had processed when it was running without the -a option.




> Please point me in the right direction. Thanks, Mike
>
>
>
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general
>


From mjames at profitpoint.com  Thu Oct  4 12:13:08 2012
From: mjames at profitpoint.com (Mike James)
Date: Thu, 4 Oct 2012 19:13:08 +0000
Subject: [Slony1-general] offline log shipping errors
In-Reply-To: <506DDD31.20507@ca.afilias.info>
References: <F024DCE3402750409CD407C414C07E1A8C3D6E@BY2PRD0811MB404.namprd08.prod.outlook.com>
	<506DDD31.20507@ca.afilias.info>
Message-ID: <F024DCE3402750409CD407C414C07E1A8C3FEB@BY2PRD0811MB404.namprd08.prod.outlook.com>

Well, if I had to guess, that's what I would think. The previous sysadmin created some scripts to manage slony, but I'm not sure that they're working effectively.

Mike

-----Original Message-----
From: Steve Singer [mailto:ssinger at ca.afilias.info] 
Sent: Thursday, October 04, 2012 3:02 PM
To: Mike James
Cc: slony1-general at lists.slony.info
Subject: Re: [Slony1-general] offline log shipping errors

On 12-10-04 02:52 PM, Mike James wrote:
> Hi, our DBA stopped log shipping to create a new replication set. When 
> he resumed log shipping, the next sequence number on the offline node 
> is not consistent with the new log sequence numbers coming from the 
> cluster. This is my 1^st experience using Postgres/Slony and I don't 
> know how to resolve this. I have not found a straightforward 
> resolution of this in Google searches - probably I'm using the wrong keywords.
>

What exactly do you mean by 'stopped log shipping' ?

Do you mean that he shutdown the slon then restarted it without the -a option?

If so I think you will need to rebuild the offline node from scratch with slony1_dump.sh because there is no longer a record of the changes that the slon had processed when it was running without the -a option.




> Please point me in the right direction. Thanks, Mike
>
>
>
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general
>




From mark.steben at drivedominion.com  Thu Oct  4 12:38:37 2012
From: mark.steben at drivedominion.com (Mark Steben)
Date: Thu, 4 Oct 2012 15:38:37 -0400
Subject: [Slony1-general] slony init_cluster problem
Message-ID: <CADyzmyzGFWNY2uFtB9RRgA7VA+enRP3XPhOruDsFrN0Bih=eOg@mail.gmail.com>

*Hi, trying to initialize a new cluster using the alt-perl scripts provided
 in the install
Here are the specs

MASTER:
linux installed on a VM setup.
(The VM is installed on a Windows 7 OS running on a HP Elitebook laptop)
   8.0.4 build-744019
 the uname -a command:
Linux localhost.localdomain 2.6.18-308.13.1.el5 #1 SMP Tue Aug 21 17:10:18
EDT 2012 x86_64 x86_64 x86_64 GNU/Linux
**total shared memory available: 2 GB
postgres installed: 8.3.21 (with enable_thread_safety)
slony installed: 2.1.1

***
*SLAVE:
linux installed on a dell desktop
(The primary OS on this machine is linux)
 the uname -a command:
Linux msteben-centos.autorevenue.com 2.6.1**8-194.11.4.el5 #1 SMP Tue Sep
21 05:04:09 EDT 2010 x86_64 x86_64 x86_64 GNU/Linux
**total shared memory available: 2 GB
**postgres installed: 8.3.21 (with enable_thread_safety)
slony installed: 2.1.1

PROBLEM:
 I attempt to run the altperl script ./slonik_init_cluster from the slave
  the connection gets through to the master, but all it does on the master
is
  print the replication schema (all the sl tables) over and over and over
again
  in the postgres logs.  It never gets to creating the _reptest schema, then
  defining the sl_tables.  When I do a query on pg_stat_activity on the
master
  the one query actually running is the CREATE TABLE sl_nodes statement.
It never
  finishes.  I finally have to kill the connection and nothing gets done.

  I've attached the postgresql.conf from both servers as well as the
slon_tools.conf
  from the slave.  The admin user referenced in the slon_tools is slony and
  is defined as a superuser.

  Any help appreciated.  Any other info you need, please let me know.

Mark Steben
 DBA at AutoRevenue    *
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20121004/7d7a3e59/attachment.htm 
-------------- next part --------------
# 
# Author: Christopher Browne
# Copyright 2004-2009 Afilias Canada
# Revised extensively by Steve Simms

# Keeping the following three lines for backwards compatibility in
# case this gets incorporated into a 1.0.6 release.
#
# TODO: The scripts should check for an environment variable
# containing the location of a configuration file.  That would
# simplify this configuration file and allow Slony-I tools to still work
# in situations where it doesn't exist.
#
if ($ENV{"SLONYNODES"}) {
    require $ENV{"SLONYNODES"};
} else {

    # The name of the replication cluster.  This will be used to
    # create a schema named _$CLUSTER_NAME in the database which will
    # contain Slony-related data.
    $CLUSTER_NAME = 'reptest';

    # The directory where Slony should record log messages.  This
    # directory will need to be writable by the user that invokes
    # Slony.
    # $LOGDIR = '/var/log/slony1';
     $LOGDIR = '/home/postgres/slony1';


    # (Optional) If you would like to use Apache's rotatelogs tool to
    # manage log output, uncomment the following line and ensure that
    # it points to the executable.
    #
    # $APACHE_ROTATOR = '/usr/local/apache/bin/rotatelogs';

    # Log line suffix for Slony-I log. For options, look at date(1) 
    # man page.
    #
    # $LOG_NAME_SUFFIX = '%a';

    # SYNC check interval (slon -s option)
    # $SYNC_CHECK_INTERVAL = 1000;

    # Which node is the default master for all sets?
    $MASTERNODE = 1;

    # Which debugging level to use?  [0-4]
    $DEBUGLEVEL = 0;

    # Include add_node lines for each node in the cluster.  Be sure to
    # use host names that will resolve properly on all nodes
    # (i.e. only use 'localhost' if all nodes are on the same host).
    # Also, note that the user must be a superuser account.

    add_node(node     => 1,
             host     => '10.10.6.136',
             dbname   => 'slonytst',
             port     => 5432,
             user     => 'slony',
             password => 'elephant1234');

    add_node(node     => 2,
             host     => '10.10.4.34',
             dbname   => 'slonytst',
             port     => 5432,
             user     => 'slony',
             password => 'elephant1234');

#    add_node(node     => 3,
#            host     => 'server3',
#            dbname   => 'database',
#            port     => 5432,
#            user     => 'postgres',
#            password => '');

    # If the node should only receive event notifications from a
    # single node (e.g. if it can't access the other nodes), you can
    # specify a single parent.  The downside to this approach is that
    # if the parent goes down, your node becomes stranded.

#    add_node(node     => 4,
#            parent   => 3,
#            host     => 'server4',
#            dbname   => 'database',
#            port     => 5432,
#            user     => 'postgres',
#             password => '');

}

# The $SLONY_SETS variable contains information about all of the sets
# in your cluster.

$SLONY_SETS = {
    "seta" => {
        "set_id" => 1,
        "table_id"    => 1,
        "sequence_id" => 1,
        "pkeyedtables" => [
"public.clients",
"public.queues",
"public.email_history",
"public.mailer_queue",
"public.queuenodes",
"public.states",
"public.emailrcpt_mileage_history",
],

"sequences" =>
    [
 "mmseq",
 "mailpollseq",
 "mailer_queue_mailer_queue_pk_seq",
 "email_history_id_seq",
 "emailrcpt_mileage_history_pk_id_seq",
   ]  
},
   
#    "set2" => {
#       "set_id"       => 2,
#       "table_id"     => 389,
#       "sequence_id"  => 204,
#       "pkeyedtables" => ["public.queuenodes"],
#       "keyedtables"  => {},
#       "sequences"    => [],
#    },

};

# Keeping the following three lines for backwards compatibility in
# case this gets incorporated into a 1.0.6 release.
#
# TODO: The scripts should check for an environment variable
# containing the location of a configuration file.  That would
# simplify this configuration file and allow Slony tools to still work
# in situations where it doesn't exist.
#
if ($ENV{"SLONYSET"}) {
    require $ENV{"SLONYSET"};
}

# Please do not add or change anything below this point.
1;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: postgresql.conf.slave
Type: application/octet-stream
Size: 16851 bytes
Desc: not available
Url : http://lists.slony.info/pipermail/slony1-general/attachments/20121004/7d7a3e59/attachment-0002.obj 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: postgresql.conf.master
Type: application/octet-stream
Size: 16740 bytes
Desc: not available
Url : http://lists.slony.info/pipermail/slony1-general/attachments/20121004/7d7a3e59/attachment-0003.obj 

From mjames at profitpoint.com  Thu Oct  4 13:11:44 2012
From: mjames at profitpoint.com (Mike James)
Date: Thu, 4 Oct 2012 20:11:44 +0000
Subject: [Slony1-general] offline log shipping errors
In-Reply-To: <F024DCE3402750409CD407C414C07E1A8C3FEB@BY2PRD0811MB404.namprd08.prod.outlook.com>
References: <F024DCE3402750409CD407C414C07E1A8C3D6E@BY2PRD0811MB404.namprd08.prod.outlook.com>
	<506DDD31.20507@ca.afilias.info>
	<F024DCE3402750409CD407C414C07E1A8C3FEB@BY2PRD0811MB404.namprd08.prod.outlook.com>
Message-ID: <F024DCE3402750409CD407C414C07E1A8C40CC@BY2PRD0811MB404.namprd08.prod.outlook.com>

OK, I was mistaken. The slon on the subscriber that ships the logs was restarted with the -a option. The slon on the Master was not started with the -a option.

Mike

-----Original Message-----
From: slony1-general-bounces at lists.slony.info [mailto:slony1-general-bounces at lists.slony.info] On Behalf Of Mike James
Sent: Thursday, October 04, 2012 3:13 PM
Cc: slony1-general at lists.slony.info
Subject: Re: [Slony1-general] offline log shipping errors

Well, if I had to guess, that's what I would think. The previous sysadmin created some scripts to manage slony, but I'm not sure that they're working effectively.

Mike

-----Original Message-----
From: Steve Singer [mailto:ssinger at ca.afilias.info]
Sent: Thursday, October 04, 2012 3:02 PM
To: Mike James
Cc: slony1-general at lists.slony.info
Subject: Re: [Slony1-general] offline log shipping errors

On 12-10-04 02:52 PM, Mike James wrote:
> Hi, our DBA stopped log shipping to create a new replication set. When 
> he resumed log shipping, the next sequence number on the offline node 
> is not consistent with the new log sequence numbers coming from the 
> cluster. This is my 1^st experience using Postgres/Slony and I don't 
> know how to resolve this. I have not found a straightforward 
> resolution of this in Google searches - probably I'm using the wrong keywords.
>

What exactly do you mean by 'stopped log shipping' ?

Do you mean that he shutdown the slon then restarted it without the -a option?

If so I think you will need to rebuild the offline node from scratch with slony1_dump.sh because there is no longer a record of the changes that the slon had processed when it was running without the -a option.




> Please point me in the right direction. Thanks, Mike
>
>
>
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general
>



_______________________________________________
Slony1-general mailing list
Slony1-general at lists.slony.info
http://lists.slony.info/mailman/listinfo/slony1-general



From ssinger at ca.afilias.info  Thu Oct  4 14:39:17 2012
From: ssinger at ca.afilias.info (Steve Singer)
Date: Thu, 04 Oct 2012 17:39:17 -0400
Subject: [Slony1-general] offline log shipping errors
In-Reply-To: <F024DCE3402750409CD407C414C07E1A8C40CC@BY2PRD0811MB404.namprd08.prod.outlook.com>
References: <F024DCE3402750409CD407C414C07E1A8C3D6E@BY2PRD0811MB404.namprd08.prod.outlook.com>
	<506DDD31.20507@ca.afilias.info>
	<F024DCE3402750409CD407C414C07E1A8C3FEB@BY2PRD0811MB404.namprd08.prod.outlook.com>
	<F024DCE3402750409CD407C414C07E1A8C40CC@BY2PRD0811MB404.namprd08.prod.outlook.com>
Message-ID: <506E0205.5020905@ca.afilias.info>

On 12-10-04 04:11 PM, Mike James wrote:
> OK, I was mistaken. The slon on the subscriber that ships the logs was restarted with the -a option. The slon on the Master was not started with the -a option.

Then I'm a bit confused about steps were done that resulted in log 
shipping getting out of sync.

1. If setup log shipping and started slon with -a on the slave
2. Added some tables to replication

I would expect log shipping to continue to work.




>
> Mike
>
> -----Original Message-----
> From: slony1-general-bounces at lists.slony.info [mailto:slony1-general-bounces at lists.slony.info] On Behalf Of Mike James
> Sent: Thursday, October 04, 2012 3:13 PM
> Cc: slony1-general at lists.slony.info
> Subject: Re: [Slony1-general] offline log shipping errors
>
> Well, if I had to guess, that's what I would think. The previous sysadmin created some scripts to manage slony, but I'm not sure that they're working effectively.
>
> Mike
>
> -----Original Message-----
> From: Steve Singer [mailto:ssinger at ca.afilias.info]
> Sent: Thursday, October 04, 2012 3:02 PM
> To: Mike James
> Cc: slony1-general at lists.slony.info
> Subject: Re: [Slony1-general] offline log shipping errors
>
> On 12-10-04 02:52 PM, Mike James wrote:
>> Hi, our DBA stopped log shipping to create a new replication set. When
>> he resumed log shipping, the next sequence number on the offline node
>> is not consistent with the new log sequence numbers coming from the
>> cluster. This is my 1^st experience using Postgres/Slony and I don't
>> know how to resolve this. I have not found a straightforward
>> resolution of this in Google searches - probably I'm using the wrong keywords.
>>
>
> What exactly do you mean by 'stopped log shipping' ?
>
> Do you mean that he shutdown the slon then restarted it without the -a option?
>
> If so I think you will need to rebuild the offline node from scratch with slony1_dump.sh because there is no longer a record of the changes that the slon had processed when it was running without the -a option.
>
>
>
>
>> Please point me in the right direction. Thanks, Mike
>>
>>
>>
>> _______________________________________________
>> Slony1-general mailing list
>> Slony1-general at lists.slony.info
>> http://lists.slony.info/mailman/listinfo/slony1-general
>>
>
>
>
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general
>
>
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general
>


From ragavendra.dba at gmail.com  Thu Oct  4 21:54:29 2012
From: ragavendra.dba at gmail.com (Raghav)
Date: Fri, 5 Oct 2012 10:24:29 +0530
Subject: [Slony1-general] slony init_cluster problem
In-Reply-To: <CADyzmyzGFWNY2uFtB9RRgA7VA+enRP3XPhOruDsFrN0Bih=eOg@mail.gmail.com>
References: <CADyzmyzGFWNY2uFtB9RRgA7VA+enRP3XPhOruDsFrN0Bih=eOg@mail.gmail.com>
Message-ID: <CANwAqWghun3J9weE2a5bAPQDAiiakhTr0+Ea+SQb06je6szABQ@mail.gmail.com>

On Fri, Oct 5, 2012 at 1:08 AM, Mark Steben
<mark.steben at drivedominion.com>wrote:

> *Hi, trying to initialize a new cluster using the alt-perl scripts
> provided
>  in the install
> Here are the specs
>
> MASTER:
> linux installed on a VM setup.
> (The VM is installed on a Windows 7 OS running on a HP Elitebook laptop)
>    8.0.4 build-744019
>  the uname -a command:
> Linux localhost.localdomain 2.6.18-308.13.1.el5 #1 SMP Tue Aug 21 17:10:18
> EDT 2012 x86_64 x86_64 x86_64 GNU/Linux
> **total shared memory available: 2 GB
> postgres installed: 8.3.21 (with enable_thread_safety)
> slony installed: 2.1.1
>
> ***
> *SLAVE:
> linux installed on a dell desktop
> (The primary OS on this machine is linux)
>  the uname -a command:
> Linux msteben-centos.autorevenue.com 2.6.1**8-194.11.4.el5 #1 SMP Tue Sep
> 21 05:04:09 EDT 2010 x86_64 x86_64 x86_64 GNU/Linux
> **total shared memory available: 2 GB
> **postgres installed: 8.3.21 (with enable_thread_safety)
> slony installed: 2.1.1
>
> PROBLEM:
>  I attempt to run the altperl script ./slonik_init_cluster from the slave
>   the connection gets through to the master, but all it does on the master
> is
>   print the replication schema (all the sl tables) over and over and over
> again
>   in the postgres logs.  It never gets to creating the _reptest schema,
> then
>   defining the sl_tables.  When I do a query on pg_stat_activity on the
> master
>   the one query actually running is the CREATE TABLE sl_nodes statement.
> It never
>   finishes.  I finally have to kill the connection and nothing gets done.
>
>   I've attached the postgresql.conf from both servers as well as the
> slon_tools.conf
>   from the slave.  The admin user referenced in the slon_tools is slony and
>   is defined as a superuser.
>
>   Any help appreciated.  Any other info you need, please let me know.
>
> Mark Steben
>  DBA at AutoRevenue    *
>
>
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general
>
>
Before doing any guesses, slony logs(also pg_logs) would be helpful to know
why exactly CREATE TABLE SL_NODE is in waiting state.

-- 
Regards
Raghav
Blog: htt://raghavt.blogspot.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20121005/ea0cf253/attachment.htm 

