From mike.james at clutch.com  Tue May 17 11:59:02 2016
From: mike.james at clutch.com (Mike James)
Date: Tue, 17 May 2016 14:59:02 -0400
Subject: [Slony1-general] removing old slony triggers
Message-ID: <CADeyJsVwrhXm-VoueW1cs8Peq7jAV6FOBu_b8-g8E4qjj8nMqQ@mail.gmail.com>

Hi, all. Due to some changes in our slony schema over the years, in our
database I now see three slony schemas. Our current replication set only
uses the most recent one. (slony 2.2.1 and PG 9.3)

In the database when I "select * from pg_trigger; " I see some triggers
from the older, unused schemas, particularly _logtrigger, _truncatetrigger
have tgenabled = O.

_denyaccess and _truncatedeny are disabled (tgenabled = D)

How do I safely remove these triggers and delete the unused slony schemas?
This maybe a simple question - but I'd rather not take the chance with the
production database. Thanks,

Mike


[image: Clutch Holdings, LLC] <http://www.clutch.com>   Mike James |
Manager of Infrastructure
267.419.6400, ext 204 | mike.james at clutch.com
201 S Maple St. | Suite 250 | Ambler, PA 19002
Clutch.com <http://www.clutch.com> | Twitter
<https://twitter.com/clutchsuccess> | LinkedIn
<https://www.linkedin.com/company/2837209> | YouTube
<https://www.youtube.com/user/clutchsuccess> | Clutch Support Center
<http://clientsupport.clutch.com/>

The only end to end consumer management platform that empowers
consumer-focused businesses to identify, target, message, and engage their
best customers.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20160517/ce1420c4/attachment.htm 

From steve at ssinger.info  Thu May 19 11:27:17 2016
From: steve at ssinger.info (Steve Singer)
Date: Thu, 19 May 2016 14:27:17 -0400
Subject: [Slony1-general] removing old slony triggers
In-Reply-To: <CADeyJsVwrhXm-VoueW1cs8Peq7jAV6FOBu_b8-g8E4qjj8nMqQ@mail.gmail.com>
References: <CADeyJsVwrhXm-VoueW1cs8Peq7jAV6FOBu_b8-g8E4qjj8nMqQ@mail.gmail.com>
Message-ID: <573E0585.4060500@ssinger.info>

On 05/17/2016 02:59 PM, Mike James wrote:
> Hi, all. Due to some changes in our slony schema over the years, in our
> database I now see three slony schemas. Our current replication set only
> uses the most recent one. (slony 2.2.1 and PG 9.3)
>
> In the database when I "select * from pg_trigger; " I see some triggers
> from the older, unused schemas, particularly _logtrigger,
> _truncatetrigger have tgenabled = O.
>
> _denyaccess and _truncatedeny are disabled (tgenabled = D)
>
> How do I safely remove these triggers and delete the unused slony
> schemas? This maybe a simple question - but I'd rather not take the
> chance with the production database. Thanks,

What version of slony is are the old schema's based on?
Depending on the version this makes a difference on how you would remove 
them.

Steve


>
> Mike
> Clutch Holdings, LLC <http://www.clutch.com>		Mike James | Manager of
> Infrastructure
> 267.419.6400, ext 204 | mike.james at clutch.com <mailto:mike.james at clutch.com>
> 201 S Maple St. | Suite 250 | Ambler, PA 19002
> Clutch.com <http://www.clutch.com> | Twitter
> <https://twitter.com/clutchsuccess> | LinkedIn
> <https://www.linkedin.com/company/2837209> | YouTube
> <https://www.youtube.com/user/clutchsuccess> | Clutch Support Center
> <http://clientsupport.clutch.com/>
>
> The only end to end consumer management platform that empowers
> consumer-focused businesses to identify, target, message, and engage
> their best customers.
>
>
>
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general
>


From mike.james at clutch.com  Thu May 19 12:26:49 2016
From: mike.james at clutch.com (Mike James)
Date: Thu, 19 May 2016 15:26:49 -0400
Subject: [Slony1-general] removing old slony triggers
In-Reply-To: <573E0585.4060500@ssinger.info>
References: <CADeyJsVwrhXm-VoueW1cs8Peq7jAV6FOBu_b8-g8E4qjj8nMqQ@mail.gmail.com>
	<573E0585.4060500@ssinger.info>
Message-ID: <CADeyJsW0GDBOzh_ptO9mBgkfKVR0sZo4WoMNuoUDKCugJZxHTg@mail.gmail.com>

Hi, Steve. I believe all of the triggers / schema were created with slony
2.2.1. Also we're currently on postgresql 9.3.5.

Mike



[image: Clutch Holdings, LLC] <http://www.clutch.com>   Mike James |
Manager of Infrastructure
267.419.6400, ext 204 | mike.james at clutch.com
201 S Maple St. | Suite 250 | Ambler, PA 19002
Clutch.com <http://www.clutch.com> | Twitter
<https://twitter.com/clutchsuccess> | LinkedIn
<https://www.linkedin.com/company/2837209> | YouTube
<https://www.youtube.com/user/clutchsuccess> | Clutch Support Center
<http://clientsupport.clutch.com/>

The only end to end consumer management platform that empowers
consumer-focused businesses to identify, target, message, and engage their
best customers.

On Thu, May 19, 2016 at 2:27 PM, Steve Singer <steve at ssinger.info> wrote:

> On 05/17/2016 02:59 PM, Mike James wrote:
>
>> Hi, all. Due to some changes in our slony schema over the years, in our
>> database I now see three slony schemas. Our current replication set only
>> uses the most recent one. (slony 2.2.1 and PG 9.3)
>>
>> In the database when I "select * from pg_trigger; " I see some triggers
>> from the older, unused schemas, particularly _logtrigger,
>> _truncatetrigger have tgenabled = O.
>>
>> _denyaccess and _truncatedeny are disabled (tgenabled = D)
>>
>> How do I safely remove these triggers and delete the unused slony
>> schemas? This maybe a simple question - but I'd rather not take the
>> chance with the production database. Thanks,
>>
>
> What version of slony is are the old schema's based on?
> Depending on the version this makes a difference on how you would remove
> them.
>
> Steve
>
>
>
>> Mike
>> Clutch Holdings, LLC <http://www.clutch.com>            Mike James |
>> Manager of
>> Infrastructure
>> 267.419.6400, ext 204 | mike.james at clutch.com <mailto:
>> mike.james at clutch.com>
>> 201 S Maple St. | Suite 250 | Ambler, PA 19002
>> Clutch.com <http://www.clutch.com> | Twitter
>> <https://twitter.com/clutchsuccess> | LinkedIn
>> <https://www.linkedin.com/company/2837209> | YouTube
>> <https://www.youtube.com/user/clutchsuccess> | Clutch Support Center
>> <http://clientsupport.clutch.com/>
>>
>> The only end to end consumer management platform that empowers
>> consumer-focused businesses to identify, target, message, and engage
>> their best customers.
>>
>>
>>
>> _______________________________________________
>> Slony1-general mailing list
>> Slony1-general at lists.slony.info
>> http://lists.slony.info/mailman/listinfo/slony1-general
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20160519/082e1559/attachment.htm 

From steve at ssinger.info  Thu May 19 12:43:23 2016
From: steve at ssinger.info (Steve Singer)
Date: Thu, 19 May 2016 15:43:23 -0400
Subject: [Slony1-general] removing old slony triggers
In-Reply-To: <CADeyJsW0GDBOzh_ptO9mBgkfKVR0sZo4WoMNuoUDKCugJZxHTg@mail.gmail.com>
References: <CADeyJsVwrhXm-VoueW1cs8Peq7jAV6FOBu_b8-g8E4qjj8nMqQ@mail.gmail.com>	<573E0585.4060500@ssinger.info>
	<CADeyJsW0GDBOzh_ptO9mBgkfKVR0sZo4WoMNuoUDKCugJZxHTg@mail.gmail.com>
Message-ID: <573E175B.8030308@ssinger.info>

On 05/19/2016 03:26 PM, Mike James wrote:
> Hi, Steve. I believe all of the triggers / schema were created with
> slony 2.2.1. Also we're currently on postgresql 9.3.5.
>

I think you should be able to just drop the other slony schema's with 
cascade and it should clean everything up.



> Mike
>
> Clutch Holdings, LLC <http://www.clutch.com>		Mike James | Manager of
> Infrastructure
> 267.419.6400, ext 204 | mike.james at clutch.com <mailto:mike.james at clutch.com>
> 201 S Maple St. | Suite 250 | Ambler, PA 19002
> Clutch.com <http://www.clutch.com> | Twitter
> <https://twitter.com/clutchsuccess> | LinkedIn
> <https://www.linkedin.com/company/2837209> | YouTube
> <https://www.youtube.com/user/clutchsuccess> | Clutch Support Center
> <http://clientsupport.clutch.com/>
>
> The only end to end consumer management platform that empowers
> consumer-focused businesses to identify, target, message, and engage
> their best customers.
>
>
> On Thu, May 19, 2016 at 2:27 PM, Steve Singer <steve at ssinger.info
> <mailto:steve at ssinger.info>> wrote:
>
>     On 05/17/2016 02:59 PM, Mike James wrote:
>
>         Hi, all. Due to some changes in our slony schema over the years,
>         in our
>         database I now see three slony schemas. Our current replication
>         set only
>         uses the most recent one. (slony 2.2.1 and PG 9.3)
>
>         In the database when I "select * from pg_trigger; " I see some
>         triggers
>         from the older, unused schemas, particularly _logtrigger,
>         _truncatetrigger have tgenabled = O.
>
>         _denyaccess and _truncatedeny are disabled (tgenabled = D)
>
>         How do I safely remove these triggers and delete the unused slony
>         schemas? This maybe a simple question - but I'd rather not take the
>         chance with the production database. Thanks,
>
>
>     What version of slony is are the old schema's based on?
>     Depending on the version this makes a difference on how you would
>     remove them.
>
>     Steve
>
>
>
>         Mike
>         Clutch Holdings, LLC <http://www.clutch.com>            Mike
>         James | Manager of
>         Infrastructure
>         267.419.6400, ext 204 <tel:267.419.6400%2C%20ext%20204> |
>         mike.james at clutch.com <mailto:mike.james at clutch.com>
>         <mailto:mike.james at clutch.com <mailto:mike.james at clutch.com>>
>         201 S Maple St. | Suite 250 | Ambler, PA 19002
>         Clutch.com <http://www.clutch.com> | Twitter
>         <https://twitter.com/clutchsuccess> | LinkedIn
>         <https://www.linkedin.com/company/2837209> | YouTube
>         <https://www.youtube.com/user/clutchsuccess> | Clutch Support Center
>         <http://clientsupport.clutch.com/>
>
>         The only end to end consumer management platform that empowers
>         consumer-focused businesses to identify, target, message, and engage
>         their best customers.
>
>
>
>         _______________________________________________
>         Slony1-general mailing list
>         Slony1-general at lists.slony.info
>         <mailto:Slony1-general at lists.slony.info>
>         http://lists.slony.info/mailman/listinfo/slony1-general
>
>
>
>
>
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general
>


From tmblue at gmail.com  Sat May 21 14:56:52 2016
From: tmblue at gmail.com (Tory M Blue)
Date: Sat, 21 May 2016 14:56:52 -0700
Subject: [Slony1-general] Slony with postgresql replication?
Message-ID: <CAEaSS0Z=tJGzgYzgBX_FOinzB-Lm4hDFzDdg_oUwrtw8zbQQHg@mail.gmail.com>

This maybe an odd request and let me preface this by saying, we have
used Slony for over 10 years, it works great, we have had no real
major issues.

However my data sets, index creation times are starting to mean that a
drop/add of my master or a full replicated slave, takes about 15 hours
to come back on line (only takes about 2 hours to copy the data, but
some indexes take 7 hours on their own).. So any maintenance that
requires a drop/add (upgrades), requires a herculean effort, even with
dropping indexes and adding them at the end manually and concurrently
(as much as possible)

So I was thinking with a master-master setup that Postgres provides,
could I run Postgres replication between the master  servers
(master/slave), and run Slony to create our read only db's (these take
a bit less than 30 minutes to create)?

I've been unsuccessful in determining why the index creation takes so
long (and right, it's not Slony, it's Postgresql!!)

I would love to keep Slony for the read only query DB's and like I
said considering moving to Postrgresql replication for the
master/master. My query DB's only need about 5% of the data that is in
the insert master/slave, so using Postgresql replication and forcing
the same huge size db on each smaller query node, doesn't sound very
appetizing.

The other issue is any heavy process causes Slony to backup, major
deletes back up, and it's just getting worse.

Is this silly, is it either/or and I should now this?

Thanks
Tory

From ssinger at ca.afilias.info  Sat May 21 16:05:40 2016
From: ssinger at ca.afilias.info (Steve Singer)
Date: Sat, 21 May 2016 19:05:40 -0400
Subject: [Slony1-general] Slony with postgresql replication?
In-Reply-To: <CAEaSS0Z=tJGzgYzgBX_FOinzB-Lm4hDFzDdg_oUwrtw8zbQQHg@mail.gmail.com>
References: <CAEaSS0Z=tJGzgYzgBX_FOinzB-Lm4hDFzDdg_oUwrtw8zbQQHg@mail.gmail.com>
Message-ID: <5740E9C4.3050804@ca.afilias.info>

On 05/21/2016 05:56 PM, Tory M Blue wrote:
> This maybe an odd request and let me preface this by saying, we have
> used Slony for over 10 years, it works great, we have had no real
> major issues.
>
> However my data sets, index creation times are starting to mean that a
> drop/add of my master or a full replicated slave, takes about 15 hours
> to come back on line (only takes about 2 hours to copy the data, but
> some indexes take 7 hours on their own).. So any maintenance that
> requires a drop/add (upgrades), requires a herculean effort, even with
> dropping indexes and adding them at the end manually and concurrently
> (as much as possible)
>
> So I was thinking with a master-master setup that Postgres provides,
> could I run Postgres replication between the master  servers
> (master/slave), and run Slony to create our read only db's (these take
> a bit less than 30 minutes to create)?

I am not sure what you mean by 'master-master'.  Postgresql core doesn't 
currently contain any 'master-master' solutions, there are numerous 
extensions or third party projects that claim some form of 
'master-master' solution each with a definition of 'master-master' and 
different limitations. It is really hard to say if slony is compatible 
with one without understanding which one you are talking about.

Postgresql core does have built in master / standby replication 
(streaming replication).

You can do a streaming replica for failover purposes and a slony replica 
for your reporting server.

If your streaming replica is an asynchronous replica then there is a 
risk that following a failover it is possible that the slony replica saw 
transactions that never made it to the streaming replica. The solution 
to this is to rebuild your slony replica following a failover (as a 
matter of procedure/practice) OR use a synchronous replica





>
> I've been unsuccessful in determining why the index creation takes so
> long (and right, it's not Slony, it's Postgresql!!)
>
> I would love to keep Slony for the read only query DB's and like I
> said considering moving to Postrgresql replication for the
> master/master. My query DB's only need about 5% of the data that is in
> the insert master/slave, so using Postgresql replication and forcing
> the same huge size db on each smaller query node, doesn't sound very
> appetizing.
>
> The other issue is any heavy process causes Slony to backup, major
> deletes back up, and it's just getting worse.
>
> Is this silly, is it either/or and I should now this?
>
> Thanks
> Tory
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general
>


