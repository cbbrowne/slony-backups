From davecramer at gmail.com  Wed Mar 18 06:50:01 2015
From: davecramer at gmail.com (Dave Cramer)
Date: Wed, 18 Mar 2015 09:50:01 -0400
Subject: [Slony1-general] replicating execute script
Message-ID: <CADK3HHJg=1-Y5yseNJf8gxhhBf2=T=gBMnYUBm4M71AmG2FkvA@mail.gmail.com>

Due to the usage of capital letters in the slony cluster execute script
fails.

I am looking to replicate execute script for DDL changes. From what I can
see execute script takes a lock out on sl_lock before executing the script,
and releases it at the end.

What else am I missing ?

Dave Cramer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20150318/75c8b05a/attachment.html 

From stephane.schildknecht at postgres.fr  Wed Mar 18 07:07:43 2015
From: stephane.schildknecht at postgres.fr (=?UTF-8?B?U3TDqXBoYW5lIFNjaGlsZGtuZWNodA==?=)
Date: Wed, 18 Mar 2015 15:07:43 +0100
Subject: [Slony1-general] sl_log_1 and sl_log_2 tables not cleaned up
In-Reply-To: <CAAbfDy_=V9QWheYvNPv9=CPVRpbXtfAB1OHnj-4X+t6A2WdYCg@mail.gmail.com>
References: <CAAbfDy9mdW1yeOJN6Z6N0Tjmvsvd1LBY0ow+9VO5eoM8vuXuZg@mail.gmail.com>	<CAECtzeVsJ_yQm+0nVgAJxz_-8ToXG5NZ2xYpQNMJnTy9+kftWg@mail.gmail.com>
	<CAAbfDy_=V9QWheYvNPv9=CPVRpbXtfAB1OHnj-4X+t6A2WdYCg@mail.gmail.com>
Message-ID: <550986AF.3040508@postgres.fr>

On 24/02/2015 10:28, Clement Thomas wrote:
> Hi,
>     Thanks for pointing it. Ya the statement_timeout was set to 0 in
> node1 and 600000 in node2 and node3. when i set it to 0 on node2 and
> node3 replication lagged. and i could see
> 
> NOTICE:  Slony-I: log switch to sl_log_2 still in progress - sl_log_1
> not truncated
> 
> i had to set statement_timeout back to 600000 to fix the replication
> issue as the nodes are in production. what is the better way to clean
> these tables?

> 

AFAICT, your replication falls behind because it has a lot of work to do.
Setting a non-zero statement_timeout prevents it to fully propagate data changes.

-- 
St?phane Schildknecht
Contact r?gional PostgreSQL pour l'Europe francophone
Loxodata - Conseil, expertise et formations
06.17.11.37.42

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
Url : http://lists.slony.info/pipermail/slony1-general/attachments/20150318/1cdd46bb/attachment.pgp 

From glynastill at yahoo.co.uk  Thu Mar 19 02:47:47 2015
From: glynastill at yahoo.co.uk (Glyn Astill)
Date: Thu, 19 Mar 2015 09:47:47 +0000 (UTC)
Subject: [Slony1-general] replicating execute script
In-Reply-To: <CADK3HHJg=1-Y5yseNJf8gxhhBf2=T=gBMnYUBm4M71AmG2FkvA@mail.gmail.com>
References: <CADK3HHJg=1-Y5yseNJf8gxhhBf2=T=gBMnYUBm4M71AmG2FkvA@mail.gmail.com>
Message-ID: <45333666.434909.1426758467158.JavaMail.yahoo@mail.yahoo.com>

> From: Dave Cramer <davecramer at gmail.com>
>To: slony <slony1-general at lists.slony.info> 
>Sent: Wednesday, 18 March 2015, 13:50
>Subject: [Slony1-general] replicating execute script
> 
>
>
>Due to the usage of capital letters in the slony cluster execute script fails.
>
>
>I am looking to replicate execute script for DDL changes. From what I can see execute script takes a lock out on sl_lock before executing the script, and releases it at the end.
>
>
>What else am I missing ?
>


Well it looks like ddlscript_complete calls updateRelname() and repair_log_triggers(true), so I guess that's part of it.  


Wouldn't it be better to try and patch execute script to handle your case sensitivity issue?

